#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПроцедурыПроведенияДокумента

Процедура СформироватьТаблицаХозрасчетный(ДокументСсылка, СтруктураДополнительныеСвойства)
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = СтруктураДополнительныеСвойства.ДляПроведения.СтруктураВременныеТаблицы.МенеджерВременныхТаблиц;
	Запрос.Текст =
		// 1. Проводки НДС по ТЧ "Разделы" 	- если "ЗачетНДС" не равен "Себестоимость".
		// 2. Проводки НДС по ТЧ "Товары" 	- если "ЗачетНДС" равен "Себестоимость".
		// 3. Проводки НДС по ТЧ "ОС" 		- если "ЗачетНДС" равен "Себестоимость".
		// 4. Проводки таможенного сопровождения по ТЧ "Товары".
		// 5. Проводки таможенного сопровождения по ТЧ "ОС".
		// 6. Проводки таможенной пошлины по ТЧ "Товары".
		// 7. Проводки таможенной пошлины по ТЧ "ОС".
		// 8. Проводки таможенного сбора по ТЧ "Товары".
		// 9. Проводки таможенного сбора по ТЧ "ОС".
		// 10. Проводки акциза по ТЧ "Товары".
		// 11. Проводки акциза по ТЧ "ОС".
		"ВЫБРАТЬ
		|	1 КАК Порядок,
		|	ВременнаяТаблицаШапка.Период КАК Период,
		|	ВременнаяТаблицаШапка.Организация КАК Организация,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС_ПодлежащийВозмещению) КАК СчетДт,
		|	ВременнаяТаблицаШапка.СчетРасчетовСКонтрагентом КАК СчетКт,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
		|	ВременнаяТаблицаШапка.Контрагент КАК СубконтоКт1,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента КАК СубконтоКт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
		|	ВременнаяТаблицаРазделы.НДС КАК Сумма,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаДт,
		|	ВременнаяТаблицаРазделы.НДС КАК ВалютнаяСуммаДт,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаКт,
		|	ВременнаяТаблицаРазделы.НДС КАК ВалютнаяСуммаКт,
		|	""НДС по импорту"" КАК Содержание,
		|	0 КАК КоличествоДт,
		|	0 КАК КоличествоКт
		|ИЗ
		|	ВременнаяТаблицаРазделы КАК ВременнаяТаблицаРазделы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаРазделы.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаРазделы.НДС <> 0
		|	И НЕ ВременнаяТаблицаРазделы.ЗачетНДС = ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.Себестоимость)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	2,
		|	ВременнаяТаблицаШапка.Период КАК Период,
		|	ВременнаяТаблицаШапка.Организация КАК Организация,
		|	ВременнаяТаблицаТовары.СчетУчета КАК СчетДт,
		|	ВременнаяТаблицаШапка.СчетРасчетовСКонтрагентом КАК СчетКт,
		|	ВременнаяТаблицаТовары.Номенклатура КАК СубконтоДт1,
		|	ВременнаяТаблицаШапка.Склад КАК СубконтоДт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
		|	ВременнаяТаблицаШапка.Контрагент КАК СубконтоКт1,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента КАК СубконтоКт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
		|	ВременнаяТаблицаТовары.СуммаНДС КАК Сумма,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаДт,
		|	ВременнаяТаблицаТовары.СуммаНДС КАК ВалютнаяСуммаДт,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаКт,
		|	ВременнаяТаблицаТовары.СуммаНДС КАК ВалютнаяСуммаКт,
		|	""НДС по импорту"" КАК Содержание,
		|	0 КАК КоличествоДт,
		|	0 КАК КоличествоКт
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаТовары.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВременнаяТаблицаРазделы КАК ВременнаяТаблицаРазделы
		|		ПО ВременнаяТаблицаТовары.КлючСвязи = ВременнаяТаблицаРазделы.КлючСвязи
		|ГДЕ
		|	ВременнаяТаблицаТовары.СуммаНДС <> 0
		|	И ВременнаяТаблицаРазделы.ЗачетНДС = ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.Себестоимость)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	3,
		|	ВременнаяТаблицаШапка.Период КАК Период,
		|	ВременнаяТаблицаШапка.Организация КАК Организация,
		|	ВременнаяТаблицаОС.СчетУчета КАК СчетДт,
		|	ВременнаяТаблицаШапка.СчетРасчетовСКонтрагентом КАК СчетКт,
		|	ВременнаяТаблицаОС.ОсновноеСредство КАК СубконтоДт1,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
		|	ВременнаяТаблицаШапка.Контрагент КАК СубконтоКт1,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента КАК СубконтоКт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
		|	ВременнаяТаблицаОС.СуммаНДС КАК Сумма,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаДт,
		|	ВременнаяТаблицаОС.СуммаНДС КАК ВалютнаяСуммаДт,
		|	ВременнаяТаблицаШапка.ВалютаДокумента КАК ВалютаКт,
		|	ВременнаяТаблицаОС.СуммаНДС КАК ВалютнаяСуммаКт,
		|	""НДС по импорту"" КАК Содержание,
		|	0 КАК КоличествоДт,
		|	0 КАК КоличествоКт
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаОС.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВременнаяТаблицаРазделы КАК ВременнаяТаблицаРазделы
		|		ПО ВременнаяТаблицаОС.КлючСвязи = ВременнаяТаблицаРазделы.КлючСвязи
		|ГДЕ
		|	ВременнаяТаблицаОС.СуммаНДС <> 0
		|	И ВременнаяТаблицаРазделы.ЗачетНДС = ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.Себестоимость)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаТовары.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),    
		|	ВременнаяТаблицаТовары.Номенклатура,
		|	ВременнаяТаблицаШапка.Склад,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаТовары.Сопровождение,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Сопровождение,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Сопровождение,
		|	""Таможенное сопровождение"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаТовары.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаТовары.Сопровождение <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	5,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаОС.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),    
		|	ВременнаяТаблицаОС.ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаОС.Сопровождение,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Сопровождение,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Сопровождение,
		|	""Таможенное сопровождение"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаОС.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаОС.Сопровождение <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	6,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаТовары.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаТовары.Номенклатура,
		|	ВременнаяТаблицаШапка.Склад,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаТовары.Пошлина,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Пошлина,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Пошлина,
		|	""Таможенная пошлина"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаТовары.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаТовары.Пошлина <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	7,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаОС.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаОС.ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаОС.Пошлина,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Пошлина,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Пошлина,
		|	""Таможенная пошлина"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаОС.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаОС.Пошлина <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	8,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаТовары.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаТовары.Номенклатура,
		|	ВременнаяТаблицаШапка.Склад,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаТовары.ТаможенныйСбор,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.ТаможенныйСбор,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.ТаможенныйСбор,
		|	""Таможенный сбор"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаТовары.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаТовары.ТаможенныйСбор <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	9,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаОС.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаОС.ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаОС.ТаможенныйСбор,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.ТаможенныйСбор,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.ТаможенныйСбор,
		|	""Таможенный сбор"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаОС.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаОС.ТаможенныйСбор <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	10,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаТовары.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаТовары.Номенклатура,
		|	ВременнаяТаблицаШапка.Склад,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаТовары.Акциз,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Акциз,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаТовары.Акциз,
		|	""Акциз"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаТовары.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаТовары.Акциз <> 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	11,
		|	ВременнаяТаблицаШапка.Период,
		|	ВременнаяТаблицаШапка.Организация,
		|	ВременнаяТаблицаОС.СчетУчета,
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СчетаКОплатеЗаТоварыИУслуги),
		|	ВременнаяТаблицаОС.ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	НЕОПРЕДЕЛЕНО,
		|	ВременнаяТаблицаОС.Акциз,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Акциз,
		|	ВременнаяТаблицаШапка.ВалютаДокумента,
		|	ВременнаяТаблицаОС.Акциз,
		|	""Акциз"",
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО ВременнаяТаблицаОС.Ссылка = ВременнаяТаблицаШапка.Ссылка
		|ГДЕ
		|	ВременнаяТаблицаОС.Акциз <> 0";	
	РезультатЗапроса = Запрос.Выполнить();
	
	СтруктураДополнительныеСвойства.ТаблицыДляДвижений.Вставить("ТаблицаХозрасчетный", РезультатЗапроса.Выгрузить());
	
КонецПроцедуры

// Формирует таблицу значений, содержащую данные для проведения по регистру.
// Таблицы значений сохраняет в свойствах структуры "ДополнительныеСвойства".
//
Процедура СформироватьТаблицаСведенияОПоступлении(СтруктураДополнительныеСвойства) 
	                   
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = СтруктураДополнительныеСвойства.ДляПроведения.СтруктураВременныеТаблицы.МенеджерВременныхТаблиц;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ВременнаяТаблицаШапка.Ссылка КАК ДокументСсылка,
		|	ВременнаяТаблицаШапка.Организация КАК Организация,
		|	ВременнаяТаблицаШапка.Период КАК ДатаСФ,
		|	ВременнаяТаблицаШапка.Период КАК ДатаПоставки,
		|	ВременнаяТаблицаШапка.Контрагент,
		|	ВременнаяТаблицаШапка.ДоговорКонтрагента,
		|	ВременнаяТаблицаШапка.Контрагент.ПризнакСтраны КАК ПризнакСтраны,
		|	ВременнаяТаблицаРазделы.БазаНДС КАК Сумма,
		|	ВременнаяТаблицаРазделы.НДС КАК СуммаНДС,
		|	ВЫБОР
		|		КОГДА НЕ &УказыватьПризнакЗачетаНДСПриПоступлении
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.ПустаяСсылка)
		|		КОГДА ВременнаяТаблицаРазделы.ЗачетНДС = ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.ПустаяСсылка)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЗачетаНДС.Зачет)
		|		ИНАЧЕ ВременнаяТаблицаРазделы.ЗачетНДС
		|	КОНЕЦ КАК ЗачетНДС
		|ПОМЕСТИТЬ ВременнаяТаблицаСтроки
		|ИЗ
		|	ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаРазделы КАК ВременнаяТаблицаРазделы
		|		ПО (ИСТИНА)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСтроки.ДокументСсылка,
		|	ВременнаяТаблицаСтроки.Организация,
		|	ВременнаяТаблицаСтроки.Контрагент,
		|	ВременнаяТаблицаСтроки.ДоговорКонтрагента,
		|	ВременнаяТаблицаСтроки.ДатаПоставки,
		|	ВременнаяТаблицаСтроки.ДатаСФ,
		|	ВременнаяТаблицаСтроки.ПризнакСтраны,
		|	ВременнаяТаблицаСтроки.ЗачетНДС,
		|	СУММА(ВременнаяТаблицаСтроки.Сумма) КАК Сумма,
		|	СУММА(ВременнаяТаблицаСтроки.СуммаНДС) КАК СуммаНДС
		|ИЗ
		|	ВременнаяТаблицаСтроки КАК ВременнаяТаблицаСтроки
		|ГДЕ
		|	(ВременнаяТаблицаСтроки.Сумма <> 0
		|	ИЛИ ВременнаяТаблицаСтроки.СуммаНДС <> 0)
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаСтроки.ДокументСсылка,
		|	ВременнаяТаблицаСтроки.Организация,
		|	ВременнаяТаблицаСтроки.Контрагент,
		|	ВременнаяТаблицаСтроки.ДоговорКонтрагента,
		|	ВременнаяТаблицаСтроки.ДатаПоставки,
		|	ВременнаяТаблицаСтроки.ДатаСФ,
		|	ВременнаяТаблицаСтроки.ПризнакСтраны,
		|	ВременнаяТаблицаСтроки.ЗачетНДС";
	Запрос.УстановитьПараметр("УказыватьПризнакЗачетаНДСПриПоступлении", СтруктураДополнительныеСвойства.УчетнаяПолитика.УказыватьПризнакЗачетаНДСПриПоступлении);
	
	СтруктураДополнительныеСвойства.ТаблицыДляДвижений.Вставить("ТаблицаСведенияОПоступлении", Запрос.Выполнить().Выгрузить());		
КонецПроцедуры 

// Формирует таблицу значений, содержащую данные для проведения по регистру.
// Таблицы значений сохраняет в свойствах структуры "ДополнительныеСвойства".
//
Процедура СформироватьТаблицаОборотыГТД(СтруктураДополнительныеСвойства) 
	                   
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = СтруктураДополнительныеСвойства.ДляПроведения.СтруктураВременныеТаблицы.МенеджерВременныхТаблиц;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ВременнаяТаблицаШапка.Организация КАК Организация,
		|	ВременнаяТаблицаШапка.Период КАК Период,
		|	ВременнаяТаблицаШапка.Курс КАК Курс,
		|	ВременнаяТаблицаШапка.Кратность КАК Кратность,
		|	ВременнаяТаблицаРазделы.Валюта КАК Валюта,
		|	ВременнаяТаблицаРазделы.СтавкаПошлины КАК СтавкаПошлины,
		|	ВременнаяТаблицаРазделы.КлючСвязи КАК КлючСвязи
		|ПОМЕСТИТЬ ВременнаяТаблицаШапкаОборотыГТД
		|ИЗ
		|	ВременнаяТаблицаРазделы КАК ВременнаяТаблицаРазделы 
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапка КАК ВременнаяТаблицаШапка
		|		ПО (ИСТИНА)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаШапкаОборотыГТД.Организация КАК Организация,
		|	ВременнаяТаблицаШапкаОборотыГТД.Период КАК Период,
		|	ВременнаяТаблицаШапкаОборотыГТД.Валюта КАК Валюта,
		|	ВременнаяТаблицаШапкаОборотыГТД.СтавкаПошлины КАК СтавкаПошлины,
		|	ВременнаяТаблицаТовары.Номенклатура КАК Номенклатура,
		|	ВременнаяТаблицаТовары.Количество КАК Количество,
		|	ВЫРАЗИТЬ(ВременнаяТаблицаТовары.Сумма / ВременнаяТаблицаТовары.Количество КАК ЧИСЛО(15,2)) КАК ЦенаВВалюте,
		|	ВЫРАЗИТЬ((ВременнаяТаблицаТовары.Сумма / ВременнаяТаблицаТовары.Количество) * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность КАК ЧИСЛО(15,2)) КАК Цена,
		|	ВЫРАЗИТЬ(ВременнаяТаблицаТовары.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность КАК ЧИСЛО(15,2)) КАК Сумма,
		|	ВременнаяТаблицаТовары.СуммаНДС КАК НДС,
		|	ВременнаяТаблицаТовары.Пошлина КАК Пошлина,
		|	ВременнаяТаблицаТовары.ТаможенныйСбор КАК ТаможенныйСбор,
		|	ВременнаяТаблицаТовары.Сопровождение КАК Сопровождение,
		|	ВременнаяТаблицаТовары.Акциз КАК Акциз,
		|	ВременнаяТаблицаТовары.ДопРасходы КАК ДопРасходы,
		|	ВЫРАЗИТЬ((ВременнаяТаблицаТовары.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность + ВременнаяТаблицаТовары.Пошлина + ВременнаяТаблицаТовары.ТаможенныйСбор + ВременнаяТаблицаТовары.Сопровождение + ВременнаяТаблицаТовары.Акциз + ВременнаяТаблицаТовары.ДопРасходы) / ВременнаяТаблицаТовары.Количество КАК ЧИСЛО(15,2)) КАК ОбщаяЦена,
		|	ВЫРАЗИТЬ(ВременнаяТаблицаТовары.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность + ВременнаяТаблицаТовары.Пошлина + ВременнаяТаблицаТовары.ТаможенныйСбор + ВременнаяТаблицаТовары.Сопровождение + ВременнаяТаблицаТовары.Акциз + ВременнаяТаблицаТовары.ДопРасходы КАК ЧИСЛО(15,2)) КАК ОбщаяСумма
		|ИЗ
		|	ВременнаяТаблицаТовары КАК ВременнаяТаблицаТовары
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапкаОборотыГТД КАК ВременнаяТаблицаШапкаОборотыГТД
		|		ПО ВременнаяТаблицаТовары.КлючСвязи = ВременнаяТаблицаШапкаОборотыГТД.КлючСвязи
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаШапкаОборотыГТД.Организация,
		|	ВременнаяТаблицаШапкаОборотыГТД.Период,
		|	ВременнаяТаблицаШапкаОборотыГТД.Валюта,
		|	ВременнаяТаблицаШапкаОборотыГТД.СтавкаПошлины,
		|	ВременнаяТаблицаОС.ОсновноеСредство,
		|	1,
		|	ВременнаяТаблицаОС.Сумма,
		|	ВЫРАЗИТЬ(ВременнаяТаблицаОС.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность КАК ЧИСЛО(15,2)),
		|	ВЫРАЗИТЬ(ВременнаяТаблицаОС.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность КАК ЧИСЛО(15,2)),
		|	ВременнаяТаблицаОС.СуммаНДС,
		|	ВременнаяТаблицаОС.Пошлина,
		|	ВременнаяТаблицаОС.ТаможенныйСбор,
		|	ВременнаяТаблицаОС.Сопровождение,
		|	ВременнаяТаблицаОС.Акциз,
		|	ВременнаяТаблицаОС.ДопРасходы,
		|	ВЫРАЗИТЬ(ВременнаяТаблицаОС.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность + ВременнаяТаблицаОС.Пошлина + ВременнаяТаблицаОС.ТаможенныйСбор + ВременнаяТаблицаОС.Сопровождение + ВременнаяТаблицаОС.Акциз + ВременнаяТаблицаОС.ДопРасходы КАК ЧИСЛО(15,2)),
		|	ВЫРАЗИТЬ(ВременнаяТаблицаОС.Сумма * ВременнаяТаблицаШапкаОборотыГТД.Курс / ВременнаяТаблицаШапкаОборотыГТД.Кратность + ВременнаяТаблицаОС.Пошлина + ВременнаяТаблицаОС.ТаможенныйСбор + ВременнаяТаблицаОС.Сопровождение + ВременнаяТаблицаОС.Акциз + ВременнаяТаблицаОС.ДопРасходы КАК ЧИСЛО(15,2))
		|ИЗ
		|	ВременнаяТаблицаОС КАК ВременнаяТаблицаОС
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВременнаяТаблицаШапкаОборотыГТД КАК ВременнаяТаблицаШапкаОборотыГТД
		|		ПО ВременнаяТаблицаОС.КлючСвязи = ВременнаяТаблицаШапкаОборотыГТД.КлючСвязи";
		
		СтруктураДополнительныеСвойства.ТаблицыДляДвижений.Вставить("ТаблицаОборотыГТД", Запрос.Выполнить().Выгрузить());		
КонецПроцедуры 

// Инициализирует таблицы значений, содержащие данные табличных частей документа.
// Таблицы значений сохраняет в свойствах структуры "ДополнительныеСвойства".
//
Процедура ИнициализироватьДанныеДокумента(ДокументСсылка, СтруктураДополнительныеСвойства) Экспорт
	
	ВалютаРегламентированногоУчета = СтруктураДополнительныеСвойства.ДляПроведения.ВалютаРегламентированногоУчета;	
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц 	= СтруктураДополнительныеСвойства.ДляПроведения.СтруктураВременныеТаблицы.МенеджерВременныхТаблиц;
	
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ГТДПоИмпорту.Ссылка,
		|	ГТДПоИмпорту.Дата КАК Период,
		|	ГТДПоИмпорту.Организация,
		|	ГТДПоИмпорту.Склад,
		|	ГТДПоИмпорту.Контрагент,
		|	ГТДПоИмпорту.Курс,
		|	ГТДПоИмпорту.Кратность,
		|	ГТДПоИмпорту.ДоговорКонтрагента,
		|	ГТДПоИмпорту.СчетРасчетовСКонтрагентом,
		|	&ВалютаДокумента	
		|ПОМЕСТИТЬ ВременнаяТаблицаШапка
		|ИЗ
		|	Документ.ГТДПоИмпорту КАК ГТДПоИмпорту
		|ГДЕ
		|	ГТДПоИмпорту.Ссылка = &ДокументСсылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГТДПоИмпортуРазделы.Ссылка,
		|	ГТДПоИмпортуРазделы.БазаНДС,
		|	ГТДПоИмпортуРазделы.НДС,
		|	ГТДПоИмпортуРазделы.ЗачетНДС,
		|	ГТДПоИмпортуРазделы.Валюта,
		|	ГТДПоИмпортуРазделы.СтавкаПошлины,
		|	ГТДПоИмпортуРазделы.КлючСвязи
		|ПОМЕСТИТЬ ВременнаяТаблицаРазделы
		|ИЗ
		|	Документ.ГТДПоИмпорту.Разделы КАК ГТДПоИмпортуРазделы
		|ГДЕ
		|	ГТДПоИмпортуРазделы.Ссылка = &ДокументСсылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГТДПоИмпортуТовары.Ссылка,
		|	ГТДПоИмпортуТовары.Номенклатура,
		|	ГТДПоИмпортуТовары.СчетУчета,
		|	ГТДПоИмпортуТовары.Количество,
		|	ГТДПоИмпортуТовары.Акциз,
		|	ГТДПоИмпортуТовары.Сумма,
		|	ГТДПоИмпортуТовары.Пошлина,
		|	ГТДПоИмпортуТовары.Сопровождение,
		|	ГТДПоИмпортуТовары.ТаможенныйСбор,
		|	ГТДПоИмпортуТовары.СуммаНДС,
		|	ГТДПоИмпортуТовары.ДопРасходы,
		|	ГТДПоИмпортуТовары.КлючСвязи
		|ПОМЕСТИТЬ ВременнаяТаблицаТовары
		|ИЗ
		|	Документ.ГТДПоИмпорту.Товары КАК ГТДПоИмпортуТовары
		|ГДЕ
		|	ГТДПоИмпортуТовары.Ссылка = &ДокументСсылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ГТДПоИмпортуОС.Ссылка,
		|	ГТДПоИмпортуОС.ОсновноеСредство,
		|	ГТДПоИмпортуОС.СчетУчета,
		|	ГТДПоИмпортуОС.Сумма,
		|	ГТДПоИмпортуОС.Акциз,
		|	ГТДПоИмпортуОС.Пошлина,
		|	ГТДПоИмпортуОС.Сопровождение,
		|	ГТДПоИмпортуОС.ТаможенныйСбор,
		|	ГТДПоИмпортуОС.ДопРасходы,
		|	ГТДПоИмпортуОС.СуммаНДС,
		|	ГТДПоИмпортуОС.КлючСвязи
		|ПОМЕСТИТЬ ВременнаяТаблицаОС
		|ИЗ
		|	Документ.ГТДПоИмпорту.ОС КАК ГТДПоИмпортуОС
		|ГДЕ
		|	ГТДПоИмпортуОС.Ссылка = &ДокументСсылка";		
	Запрос.УстановитьПараметр("ДокументСсылка", ДокументСсылка);
	Запрос.УстановитьПараметр("ВалютаДокумента", ВалютаРегламентированногоУчета);
	Запрос.Выполнить();    		
		
	СформироватьТаблицаХозрасчетный(ДокументСсылка, СтруктураДополнительныеСвойства);
	СформироватьТаблицаСведенияОПоступлении(СтруктураДополнительныеСвойства);
	СформироватьТаблицаОборотыГТД(СтруктураДополнительныеСвойства);
КонецПроцедуры // ИнициализироватьДанныеДокумента()

#КонецОбласти

#Область ВерсионированиеОбъектов

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

#КонецОбласти

#Область ИнтерфейсПечати

Функция ПечатьГТДПоИмпорту(МассивОбъектов, ОбъектыПечати, ИмяМакета)
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ 
	|	ГТДПоИмпорту.Ссылка,
	|	ГТДПоИмпорту.Дата,
	|	ГТДПоИмпорту.Номер,
	|	ГТДПоИмпорту.Организация.НаименованиеПолное КАК Покупатель,
	|	ГТДПоИмпорту.Контрагент.НаименованиеПолное КАК Таможня,
	|	ГТДПоИмпорту.СтавкаТаможенногоСбора КАК ТамСбор,
	|	ГТДПоИмпорту.СтавкаПошлины КАК Пошлина,
	|	ГТДПоИмпорту.СтавкаНДС,
	|	ГТДПоИмпорту.НомерГТД КАК ГТД,
	|	ГТДПоИмпорту.Товары. (
	|		Номенклатура КАК Товар,
	|		Количество,
	|		Цена,
	|		ФактурнаяСтоимость,
	|		СуммаДоставки КАК Доставка,
	|		СуммаДопРасходы КАК ДопРасходы,
	|		ТаможеннаяСтоимость КАК ТаможСтоимость,
	|		СуммаПошлины КАК Пошлина,
	|		СуммаТаможенногоСбора КАК ТаможСбор,
	|		СуммаАкциза КАК Акциз,
	|		СуммаСопровождения КАК Сопровождение,
	|		СуммаНДС
	|	),
	|	СтавкиНДССрезПоследних.Ставка КАК НДС
	|ИЗ
	|	Документ.ГТДПоИмпорту КАК ГТДПоИмпорту
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкиНДС.СрезПоследних КАК СтавкиНДССрезПоследних
	|	ПО ГТДПоИмпорту.СтавкаНДС = СтавкиНДССрезПоследних.СтавкаНДС
	|ГДЕ
	|	ГТДПоИмпорту.Ссылка В(&МассивОбъектов)";
	  
	Запрос.Параметры.Вставить("МассивОбъектов", МассивОбъектов);
	
	
	
	Если ИмяМакета = "ГТДПоИмпорту" Тогда
		
		ТабличныйДокумент.КлючПараметровПечати 	= "ГТДПоИмпорту_ГТДПоИмпорту";

		Результат = Запрос.Выполнить();
		Шапка = Результат.Выбрать();
		
		Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.ГТДПоИмпорту.ГТДПоИмпорту");
		ОбластьЗаголовок 		= Макет.ПолучитьОбласть("Заголовок");
		ОбластьШапка 			= Макет.ПолучитьОбласть("Шапка");
		ОбластьШапкаТаблицы 	= Макет.ПолучитьОбласть("ШапкаТаблицы");
		ОбластьНалогиИСуммы 	= Макет.ПолучитьОбласть("НалогиИСуммы");
		ОбластьСтрока 			= Макет.ПолучитьОбласть("Строка");
		ОбластьИтого 			= Макет.ПолучитьОбласть("Итого");
		
		ТабличныйДокумент.Очистить();
			 
		Пока Шапка.Следующий() Цикл 
			ОбластьЗаголовок.Параметры.Заполнить(Шапка);
			ОбластьШапка.Параметры.Заполнить(Шапка);
			
			ФактурСтоимИтого	= Шапка.Товары.Выгрузить().Итог("ФактурнаяСтоимость");
			ДоставкаИтого 		= Шапка.Товары.Выгрузить().Итог("Доставка");
			ТамСтоимИтого		= Шапка.Товары.Выгрузить().Итог("ТаможСтоимость");
			ПошлинаИтого		= Шапка.Товары.Выгрузить().Итог("Пошлина");
			ТамСборИтого		= Шапка.Товары.Выгрузить().Итог("ТаможСбор");
			АкцизИтого 			= Шапка.Товары.Выгрузить().Итог("Акциз");
			СопровИтого			= Шапка.Товары.Выгрузить().Итог("Сопровождение");
			НДСИтого			= Шапка.Товары.Выгрузить().Итог("СуммаНДС");
			СтоимИтого			= Шапка.Товары.Выгрузить().Итог("ФактурнаяСтоимость")
								  + Шапка.Товары.Выгрузить().Итог("Доставка")
								  + Шапка.Товары.Выгрузить().Итог("Пошлина")
								  + Шапка.Товары.Выгрузить().Итог("ТаможСбор")
								  + Шапка.Товары.Выгрузить().Итог("Акциз")
								  + Шапка.Товары.Выгрузить().Итог("Сопровождение");
								  
			СтруктураИтоги = Новый Структура();
	  		СтруктураИтоги.Вставить("ФактурСтоимИтого", ФактурСтоимИтого);
			СтруктураИтоги.Вставить("ДоставкаИтого", ДоставкаИтого);
			СтруктураИтоги.Вставить("ТамСтоимИтого", ТамСтоимИтого);
			СтруктураИтоги.Вставить("ПошлинаИтого", ПошлинаИтого);
			СтруктураИтоги.Вставить("ТамСборИтого", ТамСборИтого);
			СтруктураИтоги.Вставить("АкцизИтого", АкцизИтого);
			СтруктураИтоги.Вставить("СопровИтого", СопровИтого);
			СтруктураИтоги.Вставить("НДСИтого", НДСИтого);
			СтруктураИтоги.Вставить("СтоимИтого", СтоимИтого);					  
								  
			ОбластьНалогиИСуммы.Параметры.Заполнить(Шапка);
			ОбластьНалогиИСуммы.Параметры.Заполнить(СтруктураИтоги);
			
			ТабличныйДокумент.Вывести(ОбластьЗаголовок);
			ТабличныйДокумент.Вывести(ОбластьШапка);
			ТабличныйДокумент.Вывести(ОбластьШапкаТаблицы);
			ТабличныйДокумент.Вывести(ОбластьНалогиИСуммы);
			
				ВыборкаСтрокТовары = Шапка.Товары.Выбрать();              
				НомерСтроки = 1;
				Пока ВыборкаСтрокТовары.Следующий() Цикл  
					
					ОбластьСтрока.Параметры.НомерСтроки = НомерСтроки;
					ОбластьСтрока.Параметры.Заполнить(ВыборкаСтрокТовары);
					
					Стоимость	 = ВыборкаСтрокТовары.ФактурнаяСтоимость
									+ ВыборкаСтрокТовары.Доставка
									+ ВыборкаСтрокТовары.Пошлина
									+ ВыборкаСтрокТовары.ТаможСбор
									+ ВыборкаСтрокТовары.Акциз
									+ ВыборкаСтрокТовары.Сопровождение;
					
					ИтоговаяЦена = Стоимость / ВыборкаСтрокТовары.Количество;
					
					ОбластьСтрока.Параметры.Стоимость 	 = Стоимость;
					ОбластьСтрока.Параметры.ИтоговаяЦена = ИтоговаяЦена;
								
					ТабличныйДокумент.Вывести(ОбластьСтрока);
					
					НомерСтроки = НомерСтроки + 1;
					
				КонецЦикла;
				
			ОбластьИтого.Параметры.Заполнить(СтруктураИтоги);
			
			ТабличныйДокумент.Вывести(ОбластьИтого);

		КонецЦикла;
		
	Иначе
		
		ТабличныйДокумент.КлючПараметровПечати 	= "ГТДПоИмпорту_ГТДПоИмпортуПолная";	

		Результат = Запрос.Выполнить();
		Шапка = Результат.Выбрать();
		
		Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.ГТДПоИмпорту.ГТДПоИмпортуПолная");
		ОбластьЗаголовок 		= Макет.ПолучитьОбласть("Заголовок");
		ОбластьШапка 			= Макет.ПолучитьОбласть("Шапка");
		ОбластьШапкаТаблицы 	= Макет.ПолучитьОбласть("ШапкаТаблицы");
		ОбластьНалогиИСуммы 	= Макет.ПолучитьОбласть("НалогиИСуммы");
		ОбластьСтрока 			= Макет.ПолучитьОбласть("Строка");
		ОбластьИтого 			= Макет.ПолучитьОбласть("Итого");
		
		ТабличныйДокумент.Очистить();
			 
		Пока Шапка.Следующий() Цикл 
			ОбластьЗаголовок.Параметры.Заполнить(Шапка);
			ОбластьШапка.Параметры.Заполнить(Шапка);
			
			ФактурСтоимИтого	= Шапка.Товары.Выгрузить().Итог("ФактурнаяСтоимость");
			ДоставкаИтого 		= Шапка.Товары.Выгрузить().Итог("Доставка");
			ДопРасходыИтого 	= Шапка.Товары.Выгрузить().Итог("ДопРасходы");
			ТамСтоимИтого		= Шапка.Товары.Выгрузить().Итог("ТаможСтоимость");
			ПошлинаИтого		= Шапка.Товары.Выгрузить().Итог("Пошлина");
			ТамСборИтого		= Шапка.Товары.Выгрузить().Итог("ТаможСбор");
			АкцизИтого 			= Шапка.Товары.Выгрузить().Итог("Акциз");
			СопровИтого			= Шапка.Товары.Выгрузить().Итог("Сопровождение");
			НДСИтого			= Шапка.Товары.Выгрузить().Итог("СуммаНДС");
			СтоимИтого			= Шапка.Товары.Выгрузить().Итог("ФактурнаяСтоимость")
								  + Шапка.Товары.Выгрузить().Итог("Доставка")
								  + Шапка.Товары.Выгрузить().Итог("Пошлина")
								  + Шапка.Товары.Выгрузить().Итог("ТаможСбор")
								  + Шапка.Товары.Выгрузить().Итог("Акциз")
								  + Шапка.Товары.Выгрузить().Итог("Сопровождение");
			СтоимИтогоБезДост	= Шапка.Товары.Выгрузить().Итог("ФактурнаяСтоимость")
								  + Шапка.Товары.Выгрузить().Итог("Пошлина")
								  + Шапка.Товары.Выгрузить().Итог("ТаможСбор")
								  + Шапка.Товары.Выгрузить().Итог("Акциз")
								  + Шапка.Товары.Выгрузить().Итог("Сопровождение");
								  
			СтруктураИтоги = Новый Структура();
	  		СтруктураИтоги.Вставить("ФактурСтоимИтого", ФактурСтоимИтого);
			СтруктураИтоги.Вставить("ДоставкаИтого", ДоставкаИтого);
			СтруктураИтоги.Вставить("ДопРасходыИтого", ДопРасходыИтого);
			СтруктураИтоги.Вставить("ТамСтоимИтого", ТамСтоимИтого);
			СтруктураИтоги.Вставить("ПошлинаИтого", ПошлинаИтого);
			СтруктураИтоги.Вставить("ТамСборИтого", ТамСборИтого);
			СтруктураИтоги.Вставить("АкцизИтого", АкцизИтого);
			СтруктураИтоги.Вставить("СопровИтого", СопровИтого);
			СтруктураИтоги.Вставить("НДСИтого", НДСИтого);
			СтруктураИтоги.Вставить("СтоимИтого", СтоимИтого);	
			СтруктураИтоги.Вставить("СтоимИтогоБезДост", СтоимИтогоБезДост);
								  
			ОбластьНалогиИСуммы.Параметры.Заполнить(Шапка);
			ОбластьНалогиИСуммы.Параметры.Заполнить(СтруктураИтоги);
			
			ТабличныйДокумент.Вывести(ОбластьЗаголовок);
			ТабличныйДокумент.Вывести(ОбластьШапка);
			ТабличныйДокумент.Вывести(ОбластьШапкаТаблицы);
			ТабличныйДокумент.Вывести(ОбластьНалогиИСуммы);
			
				ВыборкаСтрокТовары = Шапка.Товары.Выбрать();              
				НомерСтроки = 1;
				Пока ВыборкаСтрокТовары.Следующий() Цикл  
					
					ОбластьСтрока.Параметры.НомерСтроки = НомерСтроки;
					ОбластьСтрока.Параметры.Заполнить(ВыборкаСтрокТовары);
					
					Стоимость	     = ВыборкаСтрокТовары.ФактурнаяСтоимость
									  + ВыборкаСтрокТовары.Доставка
									  + ВыборкаСтрокТовары.Пошлина
									  + ВыборкаСтрокТовары.ТаможСбор
									  + ВыборкаСтрокТовары.Акциз
									  + ВыборкаСтрокТовары.Сопровождение;
									
					СтоимостьБезДост = ВыборкаСтрокТовары.ФактурнаяСтоимость
									  + ВыборкаСтрокТовары.Пошлина
									  + ВыборкаСтрокТовары.ТаможСбор
									  + ВыборкаСтрокТовары.Акциз
									  + ВыборкаСтрокТовары.Сопровождение;
					
					ИтоговаяЦена = Стоимость / ВыборкаСтрокТовары.Количество;
					
					ОбластьСтрока.Параметры.Стоимость 	 	  = Стоимость;
					ОбластьСтрока.Параметры.СтоимостьБезДост  = СтоимостьБезДост;
					ОбластьСтрока.Параметры.ИтоговаяЦена	  = ИтоговаяЦена;
								
					ТабличныйДокумент.Вывести(ОбластьСтрока);
					
					НомерСтроки = НомерСтроки + 1;
					
				КонецЦикла;
				
			ОбластьИтого.Параметры.Заполнить(СтруктураИтоги);
			
			ТабличныйДокумент.Вывести(ОбластьИтого);

		КонецЦикла;
		
	КонецЕсли;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр)
//  ОбъектыПечати         - СписокЗначений  - значение - ссылка на объект;
//                                            представление - имя области в которой был выведен объект (выходной параметр);
//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов (выходной параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ГТДПоИмпорту") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
				"ГТДПоИмпорту", НСтр("ru = 'ГТД_По_Импорту'"), ПечатьГТДПоИмпорту(МассивОбъектов, ОбъектыПечати,"ГТДПоИмпорту"),,
				"Документ.ГТДПоИмпорту.ГТДПоИмпорту");
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ГТДПоИмпортуПолная") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
			"ГТДПоИмпортуПолная", НСтр("ru = 'ГТД_По_Импорту_Полная'"), ПечатьГТДПоИмпорту(МассивОбъектов, ОбъектыПечати, "ГТДПоИмпортуПолная"),,
			"Документ.ГТДПоИмпорту.ГТДПоИмпортуПолная");
	КонецЕсли;
		
КонецПроцедуры

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	//КомандаПечати = КомандыПечати.Добавить();
	//КомандаПечати.Идентификатор = "ГТДПоИмпорту";
	//КомандаПечати.Представление = НСтр("ru = 'ГТД_По_Импорту'");
	//КомандаПечати.ПроверкаПроведенияПередПечатью = Истина;
	//КомандаПечати.Обработчик = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
	//КомандаПечати.Порядок = 1;
	//
	//КомандаПечати = КомандыПечати.Добавить();
	//КомандаПечати.Идентификатор = "ГТДПоИмпортуПолная";
	//КомандаПечати.Представление = НСтр("ru = 'ГТД_По_Импорту_Полная'");
	//КомандаПечати.ПроверкаПроведенияПередПечатью = Истина;
	//КомандаПечати.Обработчик = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
	//КомандаПечати.Порядок = 2;
	
	// Реестр документов
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Идентификатор  = "РеестрГТДПоИмпорту";
	КомандаПечати.Представление  = НСтр("ru = 'Реестр документов'");
	КомандаПечати.ЗаголовокФормы = НСтр("ru = 'Реестр документов ""ГТД по импорту""'");
	КомандаПечати.Обработчик     = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечатиРеестраДокументов";
	КомандаПечати.СписокФорм     = "ФормаСписка";
	КомандаПечати.Порядок        = 100;
КонецПроцедуры

#КонецОбласти


#КонецЕсли
