#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

// Процедура - обработчик события ОбработкаЗаполнения объекта.
//
Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	
	ЗаполнениеОбъектовБП.ЗаполнитьДокумент(ЭтотОбъект, ДанныеЗаполнения);
	
КонецПроцедуры

#КонецОбласти
		
#Область СлужебныеПроцедурыИФункции

Процедура ЗаполнитьПодоходныйНалог(ДанныеУчетнойПолитики) Экспорт

	Если ВидСубъекта = 2 Тогда
		// Крупный
		НачалоПериода = НачалоМесяца(Дата);
		КонецПериода = КонецМесяца(Дата);
	Иначе 
		// Малый, Средний
		НачалоПериода = НачалоКвартала(Дата);
		КонецПериода = КонецКвартала(Дата);
	КонецЕсли;
		
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК СтрокаОтчетаНомерСтроки,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДанныеОтчетаПоПНОбороты.ФизЛицо) КАК КоличествоОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот) КАК ВсегоНачисленоОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот) КАК НеоблагаемаяОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот) КАК ПиИВычетыОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот) КАК ОблагаемаяОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот) КАК ПНСотрудникаОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот) КАК ДоплатаПНОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот) КАК ВсегоПНОборот
		|ПОМЕСТИТЬ ВременнаяТаблицаВсеСтроки
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(&НачалоПериода, &КонецПериода, , Организация = &Организация) КАК ДанныеОтчетаПоПНОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	0,
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт)
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Месяц, Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаВсеСтроки.СтрокаОтчетаНомерСтроки КАК НомерСтрокиОтчета,
		|	СУММА(ВременнаяТаблицаВсеСтроки.КоличествоОборот) КАК Количество,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ВсегоНачисленоОборот) КАК СуммаНачислено,
		|	СУММА(ВременнаяТаблицаВсеСтроки.НеоблагаемаяОборот) КАК СуммаНеоблагаемая,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ПиИВычетыОборот) КАК Вычеты,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ОблагаемаяОборот) КАК СуммаОблагаемая,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ПНСотрудникаОборот) КАК СуммаПНсСотрудника,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ДоплатаПНОборот) КАК СуммаПНсМРД,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ВсегоПНОборот) КАК СуммаПН,
		|	СУММА(ВременнаяТаблицаВсеСтроки.ВсегоНачисленоОборот - ВременнаяТаблицаВсеСтроки.ПиИВычетыОборот - ВременнаяТаблицаВсеСтроки.ВсегоПНОборот) КАК СуммаВыплачен
		|ИЗ
		|	ВременнаяТаблицаВсеСтроки КАК ВременнаяТаблицаВсеСтроки
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаВсеСтроки.СтрокаОтчетаНомерСтроки";
		
		//ДанныеУчетнойПолитики = БухгалтерскийУчетВызовСервераПовтИсп.ПолучитьДанныеУчетнойПолитикиОрганизаций(КонецПериода, Организация);
		
		Запрос.УстановитьПараметр("НачалоПериода", НачалоПериода);     
		Запрос.УстановитьПараметр("КонецПериода", КонецПериода);     
		Запрос.УстановитьПараметр("Организация", Организация);
		Запрос.УстановитьПараметр("СчетУчетаПоПНДляПрочихФизическихЛиц", ДанныеУчетнойПолитики.СчетУчетаПоПНДляПрочихФизическихЛиц);
		
		РезультатЗапроса = Запрос.Выполнить();
		ПодоходныйНалог.Загрузить(РезультатЗапроса.Выгрузить());
		
КонецПроцедуры

Процедура ЗаполнитьПодоходныйНалогПриложение(ДанныеУчетнойПолитики) Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК СуммаНачислено,
		|	ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК СуммаНеоблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК Вычеты,
		|	ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК СуммаОблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК СуммаПНсСотрудника,
		|	ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК СуммаПНсМРД,
		|	ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаПН,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаВыплачен
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(НАЧАЛОПЕРИОДА(&НачалоКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&НачалоКвартала, МЕСЯЦ), , Организация = &Организация) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	0,
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&НачалоКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&НачалоКвартала, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК СуммаНачислено,
		|	ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК СуммаНеоблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК Вычеты,
		|	ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК СуммаОблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК СуммаПНсСотрудника,
		|	ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК СуммаПНсМРД,
		|	ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаПН,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаВыплачен
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(НАЧАЛОПЕРИОДА(&ВторойМесяц, МЕСЯЦ), КОНЕЦПЕРИОДА(&ВторойМесяц, МЕСЯЦ), , Организация = &Организация) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	0,
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&ВторойМесяц, МЕСЯЦ), КОНЕЦПЕРИОДА(&ВторойМесяц, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК СуммаНачислено,
		|	ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК СуммаНеоблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК Вычеты,
		|	ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК СуммаОблагаемая,
		|	ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК СуммаПНсСотрудника,
		|	ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК СуммаПНсМРД,
		|	ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаПН,
		|	ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК СуммаВыплачен
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(НАЧАЛОПЕРИОДА(&КонецКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&КонецКвартала, МЕСЯЦ), , Организация = &Организация) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	0,
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт * 10),
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0,
		|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&КонецКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&КонецКвартала, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты";

		
		Запрос.УстановитьПараметр("НачалоКвартала", НачалоКвартала(Дата));
		Запрос.УстановитьПараметр("ВторойМесяц", ДобавитьМесяц(НачалоКвартала(Дата),1));
		Запрос.УстановитьПараметр("КонецКвартала", КонецКвартала(Дата));
		Запрос.УстановитьПараметр("Организация", Организация);
		Запрос.УстановитьПараметр("СчетУчетаПоПНДляПрочихФизическихЛиц", ДанныеУчетнойПолитики.СчетУчетаПоПНДляПрочихФизическихЛиц);
		
		МассивРезультатов = Запрос.ВыполнитьПакет();
		ПодоходныйНалогПервыйМесяцКвартала.Загрузить(МассивРезультатов[0].Выгрузить());
		ПодоходныйНалогВторойМесяцКвартала.Загрузить(МассивРезультатов[1].Выгрузить());
		ПодоходныйНалогТретийМесяцКвартала.Загрузить(МассивРезультатов[2].Выгрузить());
				
КонецПроцедуры

Процедура ЗаполнитьСоцфонд() Экспорт
	
		Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Физлицо КАК Физлицо,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Физлицо.Наименование КАК ФизлицоНаименование,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Категория КАК Категория,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ФОТОборот КАК ФондОплатыТруда,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ДопФОТОборот КАК ДополнительныйФондОплатыТруда,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.НачисленыеВзносыОборот КАК НачисленыеСтраховыеВзносы,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ГНПФРОборот КАК НачсиленыеВзносыПоНПФ,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.НормаДнейОборот КАК Дней,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ФактДнейОборот КАК ФактическиДней,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ПриведеннаяСЗПОборот КАК ПриведеннаяСЗПОборот
		|ПОМЕСТИТЬ ВременнаяТаблицаДанные
		|ИЗ
		|	РегистрНакопления.ДанныеДляОтчетаПоСФЕжемесячному.Обороты(&НачалоПериода, &КонецПериода, , Организация = &Организация) КАК ДанныеДляОтчетаПоСФЕжемесячномуОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаДанные.Физлицо КАК Физлицо,
		|	ВременнаяТаблицаДанные.ФизлицоНаименование КАК ФизлицоНаименование,
		|	ВременнаяТаблицаДанные.Категория КАК Категория,
		|	ВременнаяТаблицаДанные.ФондОплатыТруда КАК ФондОплатыТруда,
		|	ВременнаяТаблицаДанные.ДополнительныйФондОплатыТруда КАК ДополнительныйФондОплатыТруда,
		|	ВременнаяТаблицаДанные.НачисленыеСтраховыеВзносы КАК НачисленыеСтраховыеВзносы,
		|	ВременнаяТаблицаДанные.НачсиленыеВзносыПоНПФ КАК НачсиленыеВзносыПоНПФ,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(СотрудникиПрием.Период, &НачалоПериода) < &НачалоПериода
		|			ТОГДА &НачалоПериода
		|		ИНАЧЕ ЕСТЬNULL(СотрудникиПрием.Период, &НачалоПериода)
		|	КОНЕЦ КАК ДатаНачалаРаботы,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(СотрудникиУвольнение.Период, &КонецПериода) > &НачалоПериода
		|			ТОГДА ЕСТЬNULL(СотрудникиУвольнение.Период, &КонецПериода)
		|		ИНАЧЕ &КонецПериода
		|	КОНЕЦ КАК ДатаОкончанияРаботы,
		|	ВременнаяТаблицаДанные.Дней КАК Дней,
		|	ВременнаяТаблицаДанные.ФактическиДней КАК ФактическиДней
		|ИЗ
		|	ВременнаяТаблицаДанные КАК ВременнаяТаблицаДанные
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Сотрудники.СрезПоследних(
		|				&КонецПериода,
		|				ФизЛицо В
		|						(ВЫБРАТЬ
		|							ВременнаяТаблицаДанные.Физлицо КАК Физлицо
		|						ИЗ
		|							ВременнаяТаблицаДанные КАК ВременнаяТаблицаДанные)
		|					И Организация = &Организация
		|					И ВидСобытия = ЗНАЧЕНИЕ(Перечисление.ВидыКадровыхСобытий.Прием)) КАК СотрудникиПрием
		|		ПО ВременнаяТаблицаДанные.Физлицо = СотрудникиПрием.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Сотрудники.СрезПоследних(
		|				&КонецПериода,
		|				ФизЛицо В
		|						(ВЫБРАТЬ
		|							ВременнаяТаблицаДанные.Физлицо КАК Физлицо
		|						ИЗ
		|							ВременнаяТаблицаДанные КАК ВременнаяТаблицаДанные)
		|					И Организация = &Организация
		|					И ВидСобытия = ЗНАЧЕНИЕ(Перечисление.ВидыКадровыхСобытий.Увольнение)) КАК СотрудникиУвольнение
		|		ПО ВременнаяТаблицаДанные.Физлицо = СотрудникиУвольнение.ФизЛицо
		|
		|УПОРЯДОЧИТЬ ПО
		|	ВременнаяТаблицаДанные.ФизлицоНаименование
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаДанные.Категория КАК Категория,
		|	СУММА(ВЫБОР
		|			КОГДА ВременнаяТаблицаДанные.ПриведеннаяСЗПОборот > ВременнаяТаблицаДанные.ФондОплатыТруда
		|				ТОГДА ВременнаяТаблицаДанные.ФондОплатыТруда
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК ФОТМенее,
		|	СУММА(ВременнаяТаблицаДанные.ДополнительныйФондОплатыТруда) КАК ДополнительныйФондОплатыТруда,
		|	СУММА(ВЫБОР
		|			КОГДА ВременнаяТаблицаДанные.ПриведеннаяСЗПОборот < ВременнаяТаблицаДанные.ФондОплатыТруда
		|				ТОГДА ВременнаяТаблицаДанные.ФондОплатыТруда
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК ФОТБолее,
		|	СУММА(ВременнаяТаблицаДанные.ФондОплатыТруда + ВременнаяТаблицаДанные.ДополнительныйФондОплатыТруда) КАК Итого,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ВременнаяТаблицаДанные.Физлицо) КАК Численость
		|ИЗ
		|	ВременнаяТаблицаДанные КАК ВременнаяТаблицаДанные
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаДанные.Категория
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаДанные.НачисленыеСтраховыеВзносы КАК СуммаКтПФ_МС_ФОТФ,
		|	ВременнаяТаблицаДанные.НачсиленыеВзносыПоНПФ КАК СуммаКтГНПФ,
		|	ВременнаяТаблицаДанные.НачисленыеСтраховыеВзносы + ВременнаяТаблицаДанные.НачсиленыеВзносыПоНПФ КАК ИтогоОбязательства
		|ИЗ
		|	ВременнаяТаблицаДанные КАК ВременнаяТаблицаДанные
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(ХозрасчетныйОстатки.СуммаОстаток, 0) КАК ОстатокСтраховыхВзносов
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(&Дата, Счет В (&СписокСчетов), , Организация = &Организация) КАК ХозрасчетныйОстатки
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ЕСТЬNULL(ХозрасчетныйОстатки.СуммаОстаток, 0) КАК ОстатокПенсионногоФонда
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(&Дата, Счет = &Счет, , Организация = &Организация) КАК ХозрасчетныйОстатки";

	ДанныеУчетнойПолитики = БухгалтерскийУчетСервер.ПолучитьДанныеУчетнойПолитикиПоПерсоналу(Дата, Организация);
	МассивСчетов = Новый Массив();
	МассивСчетов.Добавить(ДанныеУчетнойПолитики.СчетУчетаРасчетовПФФ);
	МассивСчетов.Добавить(ДанныеУчетнойПолитики.СчетУчетаРасчетовМСФ);
	МассивСчетов.Добавить(ДанныеУчетнойПолитики.СчетУчетаРасчетовФОТФ);
	СчетГНПФР = ДанныеУчетнойПолитики.СчетУчетаРасчетовГНПФР;
	
	Если ДатаСдачиОтчета = '00010101' Тогда
		Запрос.УстановитьПараметр("Дата", КонецМесяца(Дата) + 1);
	Иначе
		Запрос.УстановитьПараметр("Дата", КонецДня(ДатаСдачиОтчета));
	КонецЕсли;
	Запрос.УстановитьПараметр("СписокСчетов", МассивСчетов);
	Запрос.УстановитьПараметр("Счет", СчетГНПФР);
		
	Запрос.УстановитьПараметр("НачалоПериода", НачалоМесяца(Дата));            
	Запрос.УстановитьПараметр("КонецПериода", КонецМесяца(Дата));
	Запрос.УстановитьПараметр("Организация", Организация);
	                                                                         
	РезультатЗапроса = Запрос.ВыполнитьПакет();
		                                
	СведенияОЗанятостиИЗаработнойПлате.Загрузить(РезультатЗапроса[1].Выгрузить());
	ФондОплатыТрудаПоКатегориям.Загрузить(РезультатЗапроса[2].Выгрузить());
	
	ОбязательстваПоСтраховымВзносам = 0;
	ОбязательстваПоПенсионномуФонду = 0;
	ПереплатаПоСтраховымВзносам 	= 0;
	ПереплатаПоПенсионномуФонду	 	= 0;
	
	СтраховыеВзносы = РезультатЗапроса[4].Выгрузить()[0].ОстатокСтраховыхВзносов;
	Если СтраховыеВзносы > 0 Тогда
		ПереплатаПоСтраховымВзносам = СтраховыеВзносы;
	ИначеЕсли СтраховыеВзносы < 0 Тогда
		ОбязательстваПоСтраховымВзносам = - СтраховыеВзносы;
	КонецЕсли;
	
	ПенсионныйФонд = РезультатЗапроса[5].Выгрузить()[0].ОстатокПенсионногоФонда;
	Если ПенсионныйФонд > 0 Тогда
		ПереплатаПоПенсионномуФонду = ПенсионныйФонд;
	ИначеЕсли ПенсионныйФонд < 0 Тогда
		ОбязательстваПоПенсионномуФонду = - ПенсионныйФонд;
	КонецЕсли;

КонецПроцедуры

Процедура ЗаполнитьКвартальныйОтчетСФ() Экспорт
	
		Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СоциальныйФондОбороты.ФОТФОборот КАК ФОТФ,
	|	СоциальныйФондОбороты.МСФОборот КАК МСФ,
	|	СоциальныйФондОбороты.ГНПФРОборот КАК ГНПФР,
	|	СоциальныйФондОбороты.ПФФОборот КАК ПФФ,
	|	СоциальныйФондОбороты.ПФРОборот КАК ПФР
	|ИЗ
	|	РегистрНакопления.СоциальныйФонд.Обороты(НАЧАЛОПЕРИОДА(&Период, ГОД), КОНЕЦПЕРИОДА(&Период, КВАРТАЛ), , Организация = &Организация) КАК СоциальныйФондОбороты
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОборотыДтКт.СуммаОборот КАК ПлатежиТекГода,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГосударственныйНакопительныйПенсионныйФонд)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПлатежиТекГодаГНПФР,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоМедицинскомуСтрахованию)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПлатежиТекГодаМСФ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоФондуОздоровленияТрудящихся)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПлатежиТекГодаФОТФ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоПенсионнымОтчислениям)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПлатежиТекГодаПФ,
	|	0 КАК ПлатежиТекущегоКвартала,
	|	0 КАК ПлатежиТекКварталаГНПФР,
	|	0 КАК ПлатежиТекКварталаМСФ,
	|	0 КАК ПлатежиТекКварталаФОТФ,
	|	0 КАК ПлатежиТекКварталаПФ
	|ПОМЕСТИТЬ ВременнаяТаблицаПлатежи
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(НАЧАЛОПЕРИОДА(&Период, ГОД), КОНЕЦПЕРИОДА(&Период, КВАРТАЛ), , СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыНаСоцстрах)), , , , Организация = &Организация) КАК ХозрасчетныйОборотыДтКт
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	0,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОборотыДтКт.СуммаОборот,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ГосударственныйНакопительныйПенсионныйФонд)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоМедицинскомуСтрахованию)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоФондуОздоровленияТрудящихся)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОборотыДтКт.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыПоПенсионнымОтчислениям)
	|			ТОГДА ХозрасчетныйОборотыДтКт.СуммаОборот
	|		ИНАЧЕ 0
	|	КОНЕЦ
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОборотыДтКт(НАЧАЛОПЕРИОДА(&Период, Квартал), КОНЕЦПЕРИОДА(&Период, КВАРТАЛ), , СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НачисленныеВзносыНаСоцстрах)), , , , Организация = &Организация) КАК ХозрасчетныйОборотыДтКт
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекГода) КАК ПлатежиТекГода,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекГодаГНПФР) КАК ПлатежиТекГодаГНПФР,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекГодаМСФ) КАК ПлатежиТекГодаМСФ,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекГодаФОТФ) КАК ПлатежиТекГодаФОТФ,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекГодаПФ) КАК ПлатежиТекГодаПФ,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекущегоКвартала) КАК ПлатежиТекущегоКвартала,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекКварталаГНПФР) КАК ПлатежиТекКварталаГНПФР,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекКварталаМСФ) КАК ПлатежиТекКварталаМСФ,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекКварталаФОТФ) КАК ПлатежиТекКварталаФОТФ,
	|	СУММА(ВременнаяТаблицаПлатежи.ПлатежиТекКварталаПФ) КАК ПлатежиТекКварталаПФ
	|ИЗ
	|	ВременнаяТаблицаПлатежи КАК ВременнаяТаблицаПлатежи";
	
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Период",Дата);
	
	//Показатели ежеквартальные
	ЗаполнитьСоцфондПоказателиЕжеквартальные();
		
	// Расчет по средствам гос. соц. страха
	РезультатЗапроса = Запрос.ВыполнитьПакет();

	ДанныеЗаполнения = Новый Структура;
	ДанныеЗаполнения.Вставить("ФОТФ",0);
	ДанныеЗаполнения.Вставить("МСФ",0);
	ДанныеЗаполнения.Вставить("ГНПФР",0);
	ДанныеЗаполнения.Вставить("ПФФ",0);
	ДанныеЗаполнения.Вставить("ПФР",0);
	
	Выборка = РезультатЗапроса[0].Выбрать();
	Если Выборка.Следующий() Тогда 
		ЗаполнитьЗначенияСвойств(ДанныеЗаполнения,Выборка);
	КонецЕсли;
	
	// выполнение обязательств	
	ДанныеЗаполненияПлатежи = Новый Структура;
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекГода",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекГодаГНПФР",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекГодаМСФ",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекГодаФОТФ",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекГодаПФ",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекущегоКвартала",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекКварталаГНПФР",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекКварталаМСФ",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекКварталаФОТФ",0);
	ДанныеЗаполненияПлатежи.Вставить("ПлатежиТекКварталаПФ",0);
	Выборка = РезультатЗапроса[2].Выбрать();
	Если Выборка.Следующий() Тогда 
		ЗаполнитьЗначенияСвойств(ДанныеЗаполненияПлатежи,Выборка);
	КонецЕсли;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "1";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Остаток задолженности (переплаты) плательщика по страховым взносам на начало года(+,-)'");
	СтрокаТЧ.СуммаОбязательств = 0;	
	СтрокаТЧ.НомерВыполнения = "9";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Платежи за прошлые годы, в т.ч.'");
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "1*";
	СтрокаТЧ.Обязательства = НСтр("ru = 'по ГНПФ'"); 
	СтрокаТЧ.СуммаОбязательств = 0;
	СтрокаТЧ.НомерВыполнения = "9*";
	СтрокаТЧ.Выполнение = НСтр("ru = 'ГНПФ'"); 
	СтрокаТЧ.СуммаВыполненных = 0;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "2";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Финансовые санкции'"); 
	СтрокаТЧ.НомерВыполнения = "10";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Финансовые санкции'"); 
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "3";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Всего начислено взносов с начала текущего года'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.ПФФ + ДанныеЗаполнения.ПФР + ДанныеЗаполнения.ФОТФ +  ДанныеЗаполнения.МСФ +  ДанныеЗаполнения.ГНПФР;
	СтрокаТЧ.НомерВыполнения = "11";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Платежи текущего года, из них'"); 
	СтрокаТЧ.СуммаВыполненных  = ДанныеЗаполненияПлатежи.ПлатежиТекГода;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "а";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Пенсионный фонд'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.ПФФ + ДанныеЗаполнения.ПФР;
	СтрокаТЧ.НомерВыполнения = "а";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Пенсионный фонд'"); 
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполненияПлатежи.ПлатежиТекГодаПФ;//СмПФ;
		
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "б";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Фонд медицинского страхования'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.МСФ;	
	СтрокаТЧ.НомерВыполнения = "б";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Фонд медицинского страхования'"); 
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполненияПлатежи.ПлатежиТекГодаМСФ;//СмФМС;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "в";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Фонд оздоровления трудящихся'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.ФОТФ;	
	СтрокаТЧ.НомерВыполнения = "в";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Фонд оздоровления трудящихся'");
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполненияПлатежи.ПлатежиТекГодаФОТФ;//СмФОТФ;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "г";
	СтрокаТЧ.Обязательства = НСтр("ru = 'ГНПФ'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.ГНПФР;
	СтрокаТЧ.НомерВыполнения = "г";
	СтрокаТЧ.Выполнение = НСтр("ru = 'ГНПФ'"); 
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполненияПлатежи.ПлатежиТекГодаГНПФР; //СмГНПФР;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "4";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Финансовые санкции'"); 
	СтрокаТЧ.НомерВыполнения = "12";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Фин. санкции текущего года, из них'");
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "5";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Начислено по актам проверок, в т. ч.:'"); 
	СтрокаТЧ.НомерВыполнения = "а";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Пени'");
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "а";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Доначисленные взносы, в том числе:'"); 
	СтрокаТЧ.НомерВыполнения = "б";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Штрафы'");
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "а*";
	СтрокаТЧ.Обязательства = НСтр("ru = 'по ГНПФ'"); 
	СтрокаТЧ.НомерВыполнения = "13";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Всего уплачено с начала года(10+11+12+13)'");
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполненияПлатежи.ПлатежиТекГода;

	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "б";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Снято страховых взносов(-), в т.ч.'"); 
	СтрокаТЧ.НомерВыполнения = "14";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Остаток задолженности (переплаты) плательщика на конец периода(+,-) в т.ч.'"); 
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполнения.ПФФ + ДанныеЗаполнения.ПФР + ДанныеЗаполнения.ФОТФ +  ДанныеЗаполнения.МСФ +  ДанныеЗаполнения.ГНПФР - ДанныеЗаполненияПлатежи.ПлатежиТекГода;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "б*";
	СтрокаТЧ.Обязательства = НСтр("ru = 'ГНПФ'"); 
	СтрокаТЧ.СуммаОбязательств = 0;	
	СтрокаТЧ.НомерВыполнения = "14*";
	СтрокаТЧ.Выполнение = НСтр("ru = 'ГНПФ'"); 
	СтрокаТЧ.СуммаВыполненных = ДанныеЗаполнения.ГНПФР - ДанныеЗаполненияПлатежи.ПлатежиТекГодаГНПФР;	
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "в";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Пени'"); 
	СтрокаТЧ.НомерВыполнения = "15";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Финансовые санкции'"); 
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "г";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Штрафы'"); 
	СтрокаТЧ.НомерВыполнения = "";
	СтрокаТЧ.Выполнение = "";
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "д";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Снято пени(-)'"); 
	СтрокаТЧ.НомерВыполнения = "";
	СтрокаТЧ.Выполнение = "";
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "е";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Снято штрафов(-)'"); 
	СтрокаТЧ.НомерВыполнения = "";
	СтрокаТЧ.Выполнение = "";
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "6";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Задолженность (по страх. взносам) принята по правопреемству или по договору перевода долга (+)'"); 
	СтрокаТЧ.НомерВыполнения = "16";
	СтрокаТЧ.Выполнение = НСтр("ru = 'Остаток задолженности плательщика на конец периода (+,-)'"); 
	СуммаВычисления = ДанныеЗаполнения.ПФФ + ДанныеЗаполнения.ПФР + ДанныеЗаполнения.ФОТФ +  ДанныеЗаполнения.МСФ +  ДанныеЗаполнения.ГНПФР - ДанныеЗаполненияПлатежи.ПлатежиТекГода;
	Если СуммаВычисления > 0 Тогда
		СтрокаТЧ.СуммаВыполненных = СуммаВычисления;
	Иначе
		СтрокаТЧ.СуммаВыполненных = 0;
	КонецЕсли;
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "6*";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Задолженность (по финансовым санкциям) принята по правопреемству или по договору перевода долга (+)'"); 	
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "7";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Задолженность (по страх. взносам) передана по правопреемству или по договору перевода долга (-)'"); 
	
	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "7*";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Задолженность (по финансовым санкциям) передана по правопреемству или по договору перевода долга (-)'");

	СтрокаТЧ = СоцфондОбязательстваИВыполненияЕжеквартальный.Добавить();
	СтрокаТЧ.НомерОбязательства = "8";
	СтрокаТЧ.Обязательства = НСтр("ru = 'Всего следует к платежу в СФ:'"); 
	СтрокаТЧ.СуммаОбязательств = ДанныеЗаполнения.ПФФ + ДанныеЗаполнения.ПФР + ДанныеЗаполнения.ФОТФ +  ДанныеЗаполнения.МСФ +  ДанныеЗаполнения.ГНПФР;

	
	// ПоступлениеСредствЕжеквартальное	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'На накопительный счет ЦА'"); 
	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'На аккумуляционный счет'"); 
	СтрокаТЧ.СуммаСНачалаГода  = ДанныеЗаполненияПлатежи.ПлатежиТекГодаПФ + ДанныеЗаполненияПлатежи.ПлатежиТекГодаМСФ + ДанныеЗаполненияПлатежи.ПлатежиТекГодаФОТФ;
	СтрокаТЧ.СуммаТекущая  = ДанныеЗаполненияПлатежи.ПлатежиТекКварталаПФ + ДанныеЗаполненияПлатежи.ПлатежиТекКварталаМСФ + ДанныеЗаполненияПлатежи.ПлатежиТекКварталаФОТФ;	
		
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'Накопительный счет (НПФ)'"); 
	СтрокаТЧ.СуммаСНачалаГода  = ДанныеЗаполненияПлатежи.ПлатежиТекГодаГНПФР;
	СтрокаТЧ.СуммаТекущая  = ДанныеЗаполненияПлатежи.ПлатежиТекКварталаГНПФР;
		
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'Спецсчет'"); 
	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'по извещению'");
	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'в счет погашения задолженности по страховым взносам'"); 
	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'Зачтено расходов по фонду соц. страхования (стр.18)'"); 
	
	СтрокаТЧ = ПоступлениеСредствЕжеквартальное.Добавить();
	СтрокаТЧ.Наименование = НСтр("ru = 'Итого'"); 
	СтрокаТЧ.СуммаСНачалаГода  = ДанныеЗаполненияПлатежи.ПлатежиТекГодаПФ + ДанныеЗаполненияПлатежи.ПлатежиТекГодаМСФ + ДанныеЗаполненияПлатежи.ПлатежиТекГодаФОТФ + ДанныеЗаполненияПлатежи.ПлатежиТекГодаГНПФР;
	СтрокаТЧ.СуммаТекущая  = ДанныеЗаполненияПлатежи.ПлатежиТекКварталаПФ + ДанныеЗаполненияПлатежи.ПлатежиТекКварталаМСФ + ДанныеЗаполненияПлатежи.ПлатежиТекКварталаФОТФ + ДанныеЗаполненияПлатежи.ПлатежиТекКварталаГНПФР;
	
КонецПроцедуры

Процедура ЗаполнитьСоцфондПоказателиЕжеквартальные()
	                 
	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Физлицо КАК Физлицо,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Категория КАК Категория,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ПриведеннаяСЗПОборот КАК ПриведеннаяСЗПНГ,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ФОТОборот КАК ФОТНГ,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ДопФОТОборот КАК ДопФОТНГ,
		|	0 КАК ПриведеннаяСЗПКв,
		|	0 КАК ФОТКв,
		|	0 КАК ДопФОТКв
		|ПОМЕСТИТЬ ВременнаяТаблицаСоцФондСвод
		|ИЗ
		|	РегистрНакопления.ДанныеДляОтчетаПоСФЕжемесячному.Обороты(НАЧАЛОПЕРИОДА(&Период, ГОД), КОНЕЦПЕРИОДА(&Период, КВАРТАЛ), , Организация = &Организация) КАК ДанныеДляОтчетаПоСФЕжемесячномуОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Физлицо,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.Категория,
		|	0,
		|	0,
		|	0,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ПриведеннаяСЗПОборот,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ФОТОборот,
		|	ДанныеДляОтчетаПоСФЕжемесячномуОбороты.ДопФОТОборот
		|ИЗ
		|	РегистрНакопления.ДанныеДляОтчетаПоСФЕжемесячному.Обороты(НАЧАЛОПЕРИОДА(&Период, КВАРТАЛ), КОНЕЦПЕРИОДА(&Период, КВАРТАЛ), , Организация = &Организация) КАК ДанныеДляОтчетаПоСФЕжемесячномуОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо КАК Физлицо,
		|	ВременнаяТаблицаСоцфонд.Физлицо.Пол КАК ФизлицоПол,
		|	ВременнаяТаблицаСоцфонд.Физлицо.ДатаРождения КАК ФизлицоДатаРождения,
		|	ВременнаяТаблицаСоцфонд.Категория КАК Категория,
		|	СУММА(ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ) КАК ПриведеннаяСЗПНГ,
		|	СУММА(ВременнаяТаблицаСоцфонд.ФОТНГ) КАК ФОТНГ,
		|	СУММА(ВременнаяТаблицаСоцфонд.ДопФОТНГ) КАК ДопФОТНГ,
		|	СУММА(ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв) КАК ПриведеннаяСЗПКв,
		|	СУММА(ВременнаяТаблицаСоцфонд.ФОТКв) КАК ФОТКв,
		|	СУММА(ВременнаяТаблицаСоцфонд.ДопФОТКв) КАК ДопФОТКв
		|ПОМЕСТИТЬ ВременнаяТаблицаСоцфонд
		|ИЗ
		|	ВременнаяТаблицаСоцФондСвод КАК ВременнаяТаблицаСоцфонд
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ВременнаяТаблицаСоцфонд.Физлицо.Пол,
		|	ВременнаяТаблицаСоцфонд.Физлицо.ДатаРождения,
		|	ВременнаяТаблицаСоцфонд.Категория
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ЧисленостьРаботающихЧеловекВсего) КАК Показатель,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЗначениеМеньшеСЗПНГ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЗначениеБольшеСЗПНГ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЗначениеМеньшеСЗПКв,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЗначениеБольшеСЗПКв
		|ПОМЕСТИТЬ ВременнаяТаблицаСборка
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотребленияНаКоторыйНачисленыВзносыФОТВТомЧисле),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотребленияИнвалидов1И2Группы),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.Инвалид1_2гр)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.КоличествоИнвалидов1И2Группы),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.Инвалид1_2гр)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотребленияИностранныхГражданВременноПребывающихВКР),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИностранныеГраждане)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.КолвоИнострГражданВременноПребыващихВКР),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИностранныеГраждане)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.Фонд64_69),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ВременнаяТаблицаСоцфонд.ФизлицоПол = ЗНАЧЕНИЕ(Перечисление.ПолФизическогоЛица.Мужской)
		|				ТОГДА ВременнаяТаблицаСоцфонд.ФизлицоДатаРождения = &ДатаМ
		|			КОГДА ВременнаяТаблицаСоцфонд.ФизлицоПол = ЗНАЧЕНИЕ(Перечисление.ПолФизическогоЛица.Женский)
		|				ТОГДА ВременнаяТаблицаСоцфонд.ФизлицоДатаРождения = &ДатаЖ
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.Кол64_69),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ВременнаяТаблицаСоцфонд.ФизлицоПол = ЗНАЧЕНИЕ(Перечисление.ПолФизическогоЛица.Мужской)
		|				ТОГДА ВременнаяТаблицаСоцфонд.ФизлицоДатаРождения = &ДатаМ
		|			КОГДА ВременнаяТаблицаСоцфонд.ФизлицоПол = ЗНАЧЕНИЕ(Перечисление.ПолФизическогоЛица.Женский)
		|				ТОГДА ВременнаяТаблицаСоцфонд.ФизлицоДатаРождения = &ДатаЖ
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотреблПенсионеров),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.Пенсионер)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.КолвоПенсионеров),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.Пенсионер)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотрУчастнИнвалидовВОВ),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	(ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИнвалидВОВ1_2гр)
		|			ИЛИ ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИнвалидВОВ3гр))
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.КолУчастИнвалидовВОВ),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	(ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИнвалидВОВ1_2гр)
		|			ИЛИ ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.ИнвалидВОВ3гр))
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ФондПотрМОП),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.МОП)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.КолвоМОП),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ <= ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв <= ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	ВременнаяТаблицаСоцфонд.Категория = ЗНАЧЕНИЕ(Справочник.КатегорииСотрудников.МОП)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ДополнительныйФондОплатыТруда),
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПНГ > ВременнаяТаблицаСоцфонд.ФОТНГ
		|			ТОГДА ВременнаяТаблицаСоцфонд.ДопФОТНГ
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	0,
		|	0,
		|	0
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	НЕ ВременнаяТаблицаСоцфонд.ДопФОТНГ = 0
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ВременнаяТаблицаСоцфонд.Физлицо,
		|	ЗНАЧЕНИЕ(Справочник.СтрокиОтчетаПоСФКвартальному.ДополнительныйФондОплатыТруда),
		|	0,
		|	0,
		|	ВЫБОР
		|		КОГДА ВременнаяТаблицаСоцфонд.ПриведеннаяСЗПКв > ВременнаяТаблицаСоцфонд.ФОТКв
		|			ТОГДА ВременнаяТаблицаСоцфонд.ДопФОТКв
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	0
		|ИЗ
		|	ВременнаяТаблицаСоцфонд КАК ВременнаяТаблицаСоцфонд
		|ГДЕ
		|	НЕ ВременнаяТаблицаСоцфонд.ДопФОТКв = 0
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СтрокиОтчетаПоСФКвартальному.Ссылка КАК Показатель,
		|	СтрокиОтчетаПоСФКвартальному.НомерСтроки КАК НомерОбязательства,
		|	СУММА(ВременнаяТаблицаСборка.ЗначениеМеньшеСЗПНГ) КАК ЗначениеМеньшеСЗПНГ,
		|	СУММА(ВременнаяТаблицаСборка.ЗначениеБольшеСЗПНГ) КАК ЗначениеБольшеСЗПНГ,
		|	СУММА(ВременнаяТаблицаСборка.ЗначениеМеньшеСЗПКв) КАК ЗначениеМеньшеСЗПКв,
		|	СУММА(ВременнаяТаблицаСборка.ЗначениеБольшеСЗПКв) КАК ЗначениеБольшеСЗПКв,
		|	СУММА(ЕСТЬNULL(ВременнаяТаблицаСборка.ЗначениеМеньшеСЗПНГ, 0) + ЕСТЬNULL(ВременнаяТаблицаСборка.ЗначениеБольшеСЗПНГ, 0)) КАК ВсегоСНГ,
		|	СУММА(ЕСТЬNULL(ВременнаяТаблицаСборка.ЗначениеМеньшеСЗПКв, 0) + ЕСТЬNULL(ВременнаяТаблицаСборка.ЗначениеБольшеСЗПКв, 0)) КАК ВсегоКварт
		|ИЗ
		|	ВременнаяТаблицаСборка КАК ВременнаяТаблицаСборка
		|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СтрокиОтчетаПоСФКвартальному КАК СтрокиОтчетаПоСФКвартальному
		|		ПО ВременнаяТаблицаСборка.Показатель = СтрокиОтчетаПоСФКвартальному.Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	СтрокиОтчетаПоСФКвартальному.Ссылка,
		|	СтрокиОтчетаПоСФКвартальному.НомерСтроки
		|
		|УПОРЯДОЧИТЬ ПО
		|	НомерОбязательства";
	
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("Период",Дата);	
	ДанныеУчетнойПолитики = БухгалтерскийУчетСервер.ПолучитьДанныеУчетнойПолитикиПоПерсоналу(Дата, Организация);
	Запрос.УстановитьПараметр("ДатаМ", ДанныеУчетнойПолитики.ДатаОграниченияНачисленияГНПФМужчины);
	Запрос.УстановитьПараметр("ДатаЖ", ДанныеУчетнойПолитики.ДатаОграниченияНачисленияГНПФЖенщины);
	
	СоцфондПоказателиЕжеквартальные.Загрузить(Запрос.Выполнить().Выгрузить());

КонецПроцедуры

#КонецОбласти

#КонецЕсли