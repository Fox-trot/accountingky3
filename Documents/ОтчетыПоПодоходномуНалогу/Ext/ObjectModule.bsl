#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

// Процедура - обработчик события ОбработкаЗаполнения объекта.
//
Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	
	ЗаполнениеОбъектовБП.ЗаполнитьДокумент(ЭтотОбъект, ДанныеЗаполнения);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ЗаполнитьПодоходныйНалог(ДанныеУчетнойПолитики) Экспорт
	
	Если ВидСубъекта = 2 Тогда
		// Крупный
		НачалоПериода = НачалоМесяца(Дата);
		КонецПериода = КонецМесяца(Дата);
	Иначе 
		// Малый, Средний
		НачалоПериода = НачалоКвартала(Дата);
		КонецПериода = КонецКвартала(Дата);
	КонецЕсли;
	
	// Определение отбора по подразделениям.
	МассивПодразделений = Новый Массив;
	Если ДанныеУчетнойПолитики.ПределыПоПодразделениям Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
			"ВЫБРАТЬ
			|	ПределыПоПодразделениямСрезПоследних.Подразделение КАК Подразделение
			|ИЗ
			|	РегистрСведений.ПределыПоПодразделениям.СрезПоследних(
			|			&Период,
			|			Организация = &Организация) КАК ПределыПоПодразделениямСрезПоследних
			|ГДЕ
			|	ПределыПоПодразделениямСрезПоследних.УГНС = &Контрагент";
		Запрос.УстановитьПараметр("Период", КонецПериода);
		Запрос.УстановитьПараметр("Организация", Организация);
		Запрос.УстановитьПараметр("Контрагент", Контрагент);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			МассивПодразделений.Добавить(ВыборкаДетальныеЗаписи.Подразделение);		
		КонецЦикла;
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК СтрокаОтчетаНомерСтроки,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ДанныеОтчетаПоПНОбороты.ФизЛицо) КАК КоличествоОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот) КАК ВсегоНачисленоОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот) КАК НеоблагаемаяОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот) КАК ПиИВычетыОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот) КАК ОблагаемаяОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот) КАК ПНСотрудникаОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот) КАК ДоплатаПНОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот) КАК ВсегоПНОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ПФРОборот) КАК ПФРОборот,
		|	СУММА(ДанныеОтчетаПоПНОбороты.ГНПФРОборот) КАК ГНПФРОборот
		|ПОМЕСТИТЬ ВременнаяТаблицаВсеСтроки
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(
		|			&НачалоПериода,
		|			&КонецПериода,
		|			,
		|			Организация = &Организация
		|				И Подразделение В (&МассивПодразделений)) КАК ДанныеОтчетаПоПНОбороты
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаВсеСтроки.СтрокаОтчетаНомерСтроки КАК НомерСтрокиОтчета,
		|	СУММА(ВременнаяТаблицаВсеСтроки.КоличествоОборот) КАК Количество,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ВсегоНачисленоОборот КАК ЧИСЛО(15, 2))) КАК СуммаНачислено,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.НеоблагаемаяОборот КАК ЧИСЛО(15, 2))) КАК СуммаНеоблагаемая,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ПиИВычетыОборот КАК ЧИСЛО(15, 2))) КАК Вычеты,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ОблагаемаяОборот КАК ЧИСЛО(15, 2))) КАК СуммаОблагаемая,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ПНСотрудникаОборот КАК ЧИСЛО(15, 2))) КАК СуммаПНсСотрудника,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ДоплатаПНОборот КАК ЧИСЛО(15, 2))) КАК СуммаПНсМРД,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ВсегоПНОборот КАК ЧИСЛО(15, 2))) КАК СуммаПН,
		|	СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ВсегоПНОборот КАК ЧИСЛО(15, 2))) КАК СальдоК,
		|	ВЫБОР
		|		КОГДА &НеЗаполнятьВыплатыПоЗП
		|			ТОГДА 0
		|		ИНАЧЕ СУММА(ВЫРАЗИТЬ(ВременнаяТаблицаВсеСтроки.ВсегоНачисленоОборот - ВременнаяТаблицаВсеСтроки.ПФРОборот - ВременнаяТаблицаВсеСтроки.ГНПФРОборот - ВременнаяТаблицаВсеСтроки.ВсегоПНОборот КАК ЧИСЛО(15, 2)))
		|	КОНЕЦ КАК СуммаВыплачен
		|ИЗ
		|	ВременнаяТаблицаВсеСтроки КАК ВременнаяТаблицаВсеСтроки
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаВсеСтроки.СтрокаОтчетаНомерСтроки";
	Если Округление Тогда 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "ЧИСЛО(15, 2)", "ЧИСЛО(15, 0)");
	КонецЕсли;
	
	Если ДанныеУчетнойПолитики.ПределыПоПодразделениям Тогда
		Запрос.УстановитьПараметр("МассивПодразделений", МассивПодразделений);
	Иначе 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Подразделение В (&МассивПодразделений)", "ИСТИНА");
	КонецЕсли;	
	
	Запрос.УстановитьПараметр("НачалоПериода", НачалоПериода);     
	Запрос.УстановитьПараметр("КонецПериода", КонецПериода);     
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("НеЗаполнятьВыплатыПоЗП", НеЗаполнятьВыплатыПоЗП);
	Запрос.УстановитьПараметр("СчетУчетаПоПНДляПрочихФизическихЛиц", ДанныеУчетнойПолитики.СчетУчетаПоПНДляПрочихФизическихЛиц);
	
	РезультатЗапроса = Запрос.Выполнить();
	ПодоходныйНалог.Загрузить(РезультатЗапроса.Выгрузить());
	
КонецПроцедуры

Процедура ЗаполнитьПодоходныйНалогПриложение(ДанныеУчетнойПолитики) Экспорт
	
	// Определение отбора по подразделениям.
	МассивПодразделений = Новый Массив;
	Если ДанныеУчетнойПолитики.ПределыПоПодразделениям Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
			"ВЫБРАТЬ
			|	ПределыПоПодразделениямСрезПоследних.Подразделение КАК Подразделение
			|ИЗ
			|	РегистрСведений.ПределыПоПодразделениям.СрезПоследних(
			|			&Период,
			|			Организация = &Организация
			|				И ОтделениеСФ = &ОтделениеСФ) КАК ПределыПоПодразделениямСрезПоследних";
		Запрос.УстановитьПараметр("Период", КонецКвартала(Дата));
		Запрос.УстановитьПараметр("Организация", Организация);
		Запрос.УстановитьПараметр("ОтделениеСФ", Контрагент);
		
		РезультатЗапроса = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			МассивПодразделений.Добавить(ВыборкаДетальныеЗаписи.Подразделение);		
		КонецЦикла;
	КонецЕсли;

	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК ЧИСЛО(15, 2)) КАК СуммаНачислено,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаНеоблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК ЧИСЛО(15, 2)) КАК Вычеты,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаОблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсСотрудника,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсМРД,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПН,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СальдоК,
		|	ВЫБОР
		|		КОГДА &НеЗаполнятьВыплатыПоЗП
		|			ТОГДА 0
		|		ИНАЧЕ ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПФРОборот - ДанныеОтчетаПоПНОбороты.ГНПФРОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2))
		|	КОНЕЦ КАК СуммаВыплачен
		|ПОМЕСТИТЬ ВременнаяТаблицаПервыйМесяц
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(
		|			НАЧАЛОПЕРИОДА(&НачалоКвартала, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(&НачалоКвартала, МЕСЯЦ),
		|			,
		|			Организация = &Организация
		|				И Подразделение В (&МассивПодразделений)) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	0,
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&НачалоКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&НачалоКвартала, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК ЧИСЛО(15, 2)) КАК СуммаНачислено,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаНеоблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК ЧИСЛО(15, 2)) КАК Вычеты,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаОблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсСотрудника,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсМРД,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПН,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СальдоК,
		|	ВЫБОР
		|		КОГДА &НеЗаполнятьВыплатыПоЗП
		|			ТОГДА 0
		|		ИНАЧЕ ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПФРОборот - ДанныеОтчетаПоПНОбороты.ГНПФРОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2))
		|	КОНЕЦ КАК СуммаВыплачен
		|ПОМЕСТИТЬ ВременнаяТаблицаВторойМесяц
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(
		|			НАЧАЛОПЕРИОДА(&ВторойМесяц, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(&ВторойМесяц, МЕСЯЦ),
		|			,
		|			Организация = &Организация
		|				И Подразделение В (&МассивПодразделений)) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	0,
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&ВторойМесяц, МЕСЯЦ), КОНЕЦПЕРИОДА(&ВторойМесяц, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеОтчетаПоПНОбороты.СтрокаОтчета.НомерСтроки КАК НомерСтрокиОтчета,
		|	ДанныеОтчетаПоПНОбороты.КоличествоОборот КАК Количество,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот КАК ЧИСЛО(15, 2)) КАК СуммаНачислено,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.НеоблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаНеоблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПиИВычетыОборот КАК ЧИСЛО(15, 2)) КАК Вычеты,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ОблагаемаяОборот КАК ЧИСЛО(15, 2)) КАК СуммаОблагаемая,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ПНСотрудникаОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсСотрудника,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ДоплатаПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПНсМРД,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СуммаПН,
		|	ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2)) КАК СальдоК,
		|	ВЫБОР
		|		КОГДА &НеЗаполнятьВыплатыПоЗП
		|			ТОГДА 0
		|		ИНАЧЕ ВЫРАЗИТЬ(ДанныеОтчетаПоПНОбороты.ВсегоНачисленоОборот - ДанныеОтчетаПоПНОбороты.ПФРОборот - ДанныеОтчетаПоПНОбороты.ГНПФРОборот - ДанныеОтчетаПоПНОбороты.ВсегоПНОборот КАК ЧИСЛО(15, 2))
		|	КОНЕЦ КАК СуммаВыплачен
		|ПОМЕСТИТЬ ВременнаяТаблицаТретийМесяц
		|ИЗ
		|	РегистрНакопления.ДанныеОтчетаПоПН.Обороты(
		|			НАЧАЛОПЕРИОДА(&КонецКвартала, МЕСЯЦ),
		|			КОНЕЦПЕРИОДА(&КонецКвартала, МЕСЯЦ),
		|			,
		|			Организация = &Организация
		|				И Подразделение В (&МассивПодразделений)) КАК ДанныеОтчетаПоПНОбороты
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	4,
		|	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ХозрасчетныйОбороты.КорСубконто1),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	0,
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт * 10 КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0,
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	СУММА(ВЫРАЗИТЬ(ХозрасчетныйОбороты.СуммаОборотКт КАК ЧИСЛО(15, 2))),
		|	0
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Обороты(НАЧАЛОПЕРИОДА(&КонецКвартала, МЕСЯЦ), КОНЕЦПЕРИОДА(&КонецКвартала, МЕСЯЦ), , Счет = &СчетУчетаПоПНДляПрочихФизическихЛиц, , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаПервыйМесяц.НомерСтрокиОтчета КАК НомерСтрокиОтчета,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.Количество) КАК Количество,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаНачислено) КАК СуммаНачислено,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаНеоблагаемая) КАК СуммаНеоблагаемая,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.Вычеты) КАК Вычеты,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаОблагаемая) КАК СуммаОблагаемая,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаПНсСотрудника) КАК СуммаПНсСотрудника,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаПНсМРД) КАК СуммаПНсМРД,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаПН) КАК СуммаПН,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СальдоК) КАК СальдоК,
		|	СУММА(ВременнаяТаблицаПервыйМесяц.СуммаВыплачен) КАК СуммаВыплачен
		|ИЗ
		|	ВременнаяТаблицаПервыйМесяц КАК ВременнаяТаблицаПервыйМесяц
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаПервыйМесяц.НомерСтрокиОтчета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаВторойМесяц.НомерСтрокиОтчета КАК НомерСтрокиОтчета,
		|	СУММА(ВременнаяТаблицаВторойМесяц.Количество) КАК Количество,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаНачислено) КАК СуммаНачислено,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаНеоблагаемая) КАК СуммаНеоблагаемая,
		|	СУММА(ВременнаяТаблицаВторойМесяц.Вычеты) КАК Вычеты,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаОблагаемая) КАК СуммаОблагаемая,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаПНсСотрудника) КАК СуммаПНсСотрудника,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаПНсМРД) КАК СуммаПНсМРД,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаПН) КАК СуммаПН,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СальдоК) КАК СальдоК,
		|	СУММА(ВременнаяТаблицаВторойМесяц.СуммаВыплачен) КАК СуммаВыплачен
		|ИЗ
		|	ВременнаяТаблицаВторойМесяц КАК ВременнаяТаблицаВторойМесяц
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаВторойМесяц.НомерСтрокиОтчета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВременнаяТаблицаТретийМесяц.НомерСтрокиОтчета КАК НомерСтрокиОтчета,
		|	СУММА(ВременнаяТаблицаТретийМесяц.Количество) КАК Количество,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаНачислено) КАК СуммаНачислено,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаНеоблагаемая) КАК СуммаНеоблагаемая,
		|	СУММА(ВременнаяТаблицаТретийМесяц.Вычеты) КАК Вычеты,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаОблагаемая) КАК СуммаОблагаемая,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаПНсСотрудника) КАК СуммаПНсСотрудника,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаПНсМРД) КАК СуммаПНсМРД,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаПН) КАК СуммаПН,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СальдоК) КАК СальдоК,
		|	СУММА(ВременнаяТаблицаТретийМесяц.СуммаВыплачен) КАК СуммаВыплачен
		|ИЗ
		|	ВременнаяТаблицаТретийМесяц КАК ВременнаяТаблицаТретийМесяц
		|
		|СГРУППИРОВАТЬ ПО
		|	ВременнаяТаблицаТретийМесяц.НомерСтрокиОтчета";
	Если Округление Тогда 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "ЧИСЛО(15, 2)", "ЧИСЛО(15, 0)");
	КонецЕсли;
	
	Если МассивПодразделений.Количество() = 0 Тогда 
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "Подразделение В (&МассивПодразделений)", "ИСТИНА");
	Иначе 
		Запрос.УстановитьПараметр("МассивПодразделений", МассивПодразделений);
	КонецЕсли;	

	Запрос.УстановитьПараметр("НачалоКвартала", НачалоКвартала(Дата));
	Запрос.УстановитьПараметр("ВторойМесяц", ДобавитьМесяц(НачалоКвартала(Дата),1));
	Запрос.УстановитьПараметр("КонецКвартала", КонецКвартала(Дата));
	Запрос.УстановитьПараметр("Организация", Организация);
	Запрос.УстановитьПараметр("СчетУчетаПоПНДляПрочихФизическихЛиц", ДанныеУчетнойПолитики.СчетУчетаПоПНДляПрочихФизическихЛиц);
	Запрос.УстановитьПараметр("НеЗаполнятьВыплатыПоЗП", НеЗаполнятьВыплатыПоЗП);
	
	МассивРезультатов = Запрос.ВыполнитьПакет();
	ПодоходныйНалогПервыйМесяцКвартала.Загрузить(МассивРезультатов[3].Выгрузить());
	ПодоходныйНалогВторойМесяцКвартала.Загрузить(МассивРезультатов[4].Выгрузить());
	ПодоходныйНалогТретийМесяцКвартала.Загрузить(МассивРезультатов[5].Выгрузить());
	
	Для Каждого СтрокаТабличнойЧасти Из ПодоходныйНалог Цикл
		
		СтрокаТабличнойЧастиПервыйМесяц = ПодоходныйНалогПервыйМесяцКвартала.Найти(СтрокаТабличнойЧасти.НомерСтрокиОтчета, "НомерСтрокиОтчета");
		СтрокаТабличнойЧастиВторойМесяц = ПодоходныйНалогВторойМесяцКвартала.Найти(СтрокаТабличнойЧасти.НомерСтрокиОтчета, "НомерСтрокиОтчета");
		СтрокаТабличнойЧастиТретийМесяц = ПодоходныйНалогТретийМесяцКвартала.Найти(СтрокаТабличнойЧасти.НомерСтрокиОтчета, "НомерСтрокиОтчета");
		
		ОбщееКоличество = 0;
		
		Если СтрокаТабличнойЧастиПервыйМесяц <> Неопределено Тогда
			ОбщееКоличество = ОбщееКоличество + СтрокаТабличнойЧастиПервыйМесяц.Количество;			
		КонецЕсли;
		
		Если СтрокаТабличнойЧастиВторойМесяц <> Неопределено Тогда
			ОбщееКоличество = ОбщееКоличество + СтрокаТабличнойЧастиВторойМесяц.Количество;			
		КонецЕсли;
		
		Если СтрокаТабличнойЧастиТретийМесяц <> Неопределено Тогда
			ОбщееКоличество = ОбщееКоличество + СтрокаТабличнойЧастиТретийМесяц.Количество;			
		КонецЕсли;
		
		СтрокаТабличнойЧасти.Количество = ?(ОбщееКоличество = 0, 0, ОбщееКоличество / 3);
	КонецЦикла;
КонецПроцедуры

#КонецОбласти

#Иначе
ВызватьИсключение НСтр("ru = 'Недопустимый вызов объекта на клиенте.'");
#КонецЕсли