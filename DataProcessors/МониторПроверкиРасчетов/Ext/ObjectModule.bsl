Функция ПечатьСчетДоговоры(НачПериода, КонПериода) Экспорт
	ВидыСубконто = Новый Массив;
	ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты);
	ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры);
	
	ТабДок = Новый ТабличныйДокумент;
	Макет = ЭтотОбъект.ПолучитьМакет("Макет");
	
	Запрос = Новый Запрос;	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Контрагент,
	|	ХозрасчетныйОстаткиИОбороты.Субконто2 КАК Договор,
	|	ХозрасчетныйОстаткиИОбороты.Счет КАК Счет,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстатокДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаНачальныйОстатокДт
	|	КОНЕЦ КАК СальдоНДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстатокКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаНачальныйОстатокКт
	|	КОНЕЦ КАК СальдоНКт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаОборотДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотДт
	|	КОНЕЦ КАК ОборотыДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаОборотКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотКт
	|	КОНЕЦ КАК ОборотыКт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаКонечныйОстатокДт
	|	КОНЕЦ КАК СальдоКДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаКонечныйОстатокКт
	|	КОНЕЦ КАК СальдоККт,
	|	ХозрасчетныйОстаткиИОбороты.Субконто2.Код КАК КодДоговора,
	|	ХозрасчетныйОстаткиИОбороты.Субконто2.ВидДоговора КАК ВидДоговора,
	|	ХозрасчетныйОстаткиИОбороты.Валюта.Наименование КАК Валюта
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачПериода, &КонПериода, Авто, , Счет <> ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНААвансы), &ВидыСубконто, ) КАК ХозрасчетныйОстаткиИОбороты
	|
	|УПОРЯДОЧИТЬ ПО
	|	Контрагент,
	|	Договор,
	|	Счет
	|АВТОУПОРЯДОЧИВАНИЕ";
	
	Запрос.УстановитьПараметр("НачПериода",		НачалоДня(НачПериода));
	Запрос.УстановитьПараметр("КонПериода",		КонецДня(КонПериода));
	Запрос.УстановитьПараметр("ВидыСубконто",	ВидыСубконто);
	
	Результат 	= Запрос.Выполнить();
		
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	ОбластьДетали = Макет.ПолучитьОбласть("Детали");
	//ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
	//ОбластьПодвалТаблицы = Макет.ПолучитьОбласть("ПодвалТаблицы");
	//ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");
	
	ТабДок.Очистить();
	ТабДок.Вывести(ОбластьЗаголовок);
	//ТабДок.Вывести(ОбластьШапкаТаблицы);
	ТабДок.НачатьАвтогруппировкуСтрок();
	
	ВыборкаДетальныеЗаписи = Результат.Выбрать();
	
	//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	//	ОбластьДетали.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
	//	ТабДок.Вывести(ОбластьДетали, ВыборкаДетальныеЗаписи.Уровень());
	//КонецЦикла;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ЗаполнитьЗначенияСвойств(ОбластьДетали.Параметры, ВыборкаДетальныеЗаписи);
		ТабДок.Вывести(ОбластьДетали);
	КонецЦикла;
	
	
	ТабДок.ЗакончитьАвтогруппировкуСтрок();
	
	Возврат ТабДок;

	
КонецФункции

Функция ПечатьДоговоры(НачПериода, КонПериода) Экспорт
	ВидыСубконто = Новый Массив;
	ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты);
	ВидыСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры);
	
	ТабДок = Новый ТабличныйДокумент;
	Макет = ЭтотОбъект.ПолучитьМакет("Макет");
	
	Запрос = Новый Запрос;	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Субконто2 КАК Контрагент,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Договор,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстатокДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаНачальныйОстатокДт
	|	КОНЕЦ КАК СальдоНДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстатокКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаНачальныйОстатокКт
	|	КОНЕЦ КАК СальдоНКт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаОборотДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотДт
	|	КОНЕЦ КАК ОборотыДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаОборотКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотКт
	|	КОНЕЦ КАК ОборотыКт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокДт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаКонечныйОстатокДт
	|	КОНЕЦ КАК СальдоКДт,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Валюта.Наименование = ""сом""
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокКт
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаКонечныйОстатокКт
	|	КОНЕЦ КАК СальдоККт,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1.Код КАК КодДоговора,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1.ВидДоговора КАК ВидДоговора,
	|	ХозрасчетныйОстаткиИОбороты.Валюта.Наименование КАК Валюта
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачПериода, &КонПериода, Авто, , Счет <> ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНААвансы), &ВидыСубконто, ) КАК ХозрасчетныйОстаткиИОбороты
	|
	|УПОРЯДОЧИТЬ ПО
	|	Контрагент,
	|	Договор
	|АВТОУПОРЯДОЧИВАНИЕ";
	
	Запрос.УстановитьПараметр("НачПериода",		НачалоДня(НачПериода));
	Запрос.УстановитьПараметр("КонПериода",		КонецДня(КонПериода));
	Запрос.УстановитьПараметр("ВидыСубконто",	ВидыСубконто);
	
	Результат 	= Запрос.Выполнить();
		
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	ОбластьДетали = Макет.ПолучитьОбласть("Детали");
	//ОбластьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
	//ОбластьПодвалТаблицы = Макет.ПолучитьОбласть("ПодвалТаблицы");
	//ОбластьДетальныхЗаписей = Макет.ПолучитьОбласть("Детали");
	
	ТабДок.Очистить();
	ТабДок.Вывести(ОбластьЗаголовок);
	//ТабДок.Вывести(ОбластьШапкаТаблицы);
	ТабДок.НачатьАвтогруппировкуСтрок();
	
	ВыборкаДетальныеЗаписи = Результат.Выбрать();
	
	//Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	//	ОбластьДетали.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
	//	ТабДок.Вывести(ОбластьДетали, ВыборкаДетальныеЗаписи.Уровень());
	//КонецЦикла;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ЗаполнитьЗначенияСвойств(ОбластьДетали.Параметры, ВыборкаДетальныеЗаписи);
		ТабДок.Вывести(ОбластьДетали);
	КонецЦикла;
	
	
	ТабДок.ЗакончитьАвтогруппировкуСтрок();
	
	Возврат ТабДок;

	
КонецФункции

