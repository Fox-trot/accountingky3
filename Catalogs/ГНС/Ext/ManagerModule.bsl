#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Процедура - Заполнить по умолчанию
// Выполняет первоночальное заполнение
Процедура ЗаполнитьПоУмолчанию(Количество = Неопределено) Экспорт 
	СправочникМенеджер = Справочники.ГНС;

	ИмяВременногоФайла = ПолучитьИмяВременногоФайла();
	Макет = СправочникМенеджер.ПолучитьМакет("МакетЗаполнения");
	Макет.Записать(ИмяВременногоФайла);  
	ТаблицаЗаполнения = ЗначениеИзФайла(ИмяВременногоФайла);
	
	Для Каждого СтрокаТаблицыЗначений Из ТаблицаЗаполнения Цикл 
		СправочникСсылка = СправочникМенеджер.НайтиПоКоду(СтрокаТаблицыЗначений.Код);
		
		Если ЗначениеЗаполнено(СправочникСсылка) Тогда
			СправочникОбъект = СправочникСсылка.ПолучитьОбъект();	
		Иначе 
			СправочникОбъект = СправочникМенеджер.СоздатьЭлемент();
		КонецЕсли;	
		
		СправочникОбъект.Код = СтрокаТаблицыЗначений.Код;
		СправочникОбъект.Наименование = СтрокаТаблицыЗначений.Наименование;
		
		БухгалтерскийУчетКлиентСервер.ЗаписатьСправочникОбъект(СправочникОбъект);
	КонецЦикла;
	
	Если Количество <> Неопределено Тогда		
		Количество = ТаблицаЗаполнения.Количество();
	КонецЕсли;
	
КонецПроцедуры // ЗаполнитьПоУмолчанию()	

#КонецОбласти	

#КонецЕсли
