#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Функция - выполняет первоночальное заполнение.
//
// Возвращаемое значение:
//   Количество - Число - количество созданных элементов справочника.
//
Функция ЗаполнитьПоУмолчанию() Экспорт 
	СправочникМенеджер = Справочники.ГНС;

	ИмяВременногоФайла = ПолучитьИмяВременногоФайла();
	Макет = СправочникМенеджер.ПолучитьМакет("МакетЗаполнения");
	Макет.Записать(ИмяВременногоФайла);  
	ТаблицаЗаполнения = ЗначениеИзФайла(ИмяВременногоФайла);
	
	Для Каждого СтрокаТаблицыЗначений Из ТаблицаЗаполнения Цикл 
		СправочникСсылка = СправочникМенеджер.НайтиПоКоду(СтрокаТаблицыЗначений.Код);
		
		Если ЗначениеЗаполнено(СправочникСсылка) Тогда
			СправочникОбъект = СправочникСсылка.ПолучитьОбъект();	
		Иначе 
			СправочникОбъект = СправочникМенеджер.СоздатьЭлемент();
		КонецЕсли;	
		
		СправочникОбъект.Код = СтрокаТаблицыЗначений.Код;
		СправочникОбъект.Наименование = СтрокаТаблицыЗначений.Наименование;
		
		БухгалтерскийУчетКлиентСервер.ЗаписатьСправочникОбъект(СправочникОбъект,,,,Истина);
	КонецЦикла;
			
	Возврат ТаблицаЗаполнения.Количество();
	
КонецФункции // ЗаполнитьПоУмолчанию()	

#КонецОбласти	

#КонецЕсли
