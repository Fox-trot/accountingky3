#Область ОбработчикиСобытийФормы
//Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ВсеНастройкиПриИзменении(Элемент)
	УстановитьОтборНастроек();
КонецПроцедуры

&НаКлиенте
Процедура СтраницыПриСменеСтраницы(Элемент, ТекущаяСтраница)
	
	Если Элементы.Страницы.ТекущаяСтраница = Элементы.ГруппаНастройки И Объект.Отчет.Количество() > 0 Тогда
		УстановитьОтборНастроек();	
	КонецЕсли;

КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура БазовыеНастройки(Команда)
	
	Если Объект.Отчет.Количество() > 0 Тогда 
		ДополнительныеПараметры = Новый Структура();
		ОписаниеОповещения = Новый ОписаниеОповещения("ОтветНаВопросЗаполнитьТабличыеЧасти", ЭтотОбъект, ДополнительныеПараметры);
		ТекстВопроса = НСтр("ru = 'Табличные части будут очищены! Продолжить выполнение операции?'");
		ПоказатьВопрос(ОписаниеОповещения, ТекстВопроса, РежимДиалогаВопрос.ДаНет, 60);	
	Иначе
		ЗаполнитьТабличныеЧастиНаСервере();
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура НомераПроходов(Команда)
	НомераПроходовНаСервере();
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиРезультатовИнтерактивныхДействий

&НаКлиенте
Процедура ОтветНаВопросЗаполнитьТабличыеЧасти(РезультатВопроса, ДополнительныеПараметры) Экспорт
	Если РезультатВопроса = КодВозвратаДиалога.Да Тогда
		Объект.Отчет.Очистить();
		Объект.Настройки.Очистить();
        ЗаполнитьТабличныеЧастиНаСервере();
		Предупреждение("Загрузка базовых настроек завершена!");		
    КонецЕсли;
КонецПроцедуры // ЗаполнитьПоОснованию()

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура УстановитьОтборНастроек()
	Если Объект.Отчет.Количество() = 0 Тогда
		Возврат
	КонецЕсли;
	
	ТекСтрока = Элементы.Отчет.ТекущиеДанные;
	Если ТекСтрока <> Неопределено Тогда		
		Если не ВсеНастройки Тогда
			ФиксированнаяСтруктура = Новый ФиксированнаяСтруктура("Строка", ТекСтрока.Строка);
			Элементы.Настройки.ОтборСтрок = ФиксированнаяСтруктура;
		Иначе 
			Элементы.Настройки.ОтборСтрок = Неопределено;
		КонецЕсли;	
	Иначе
		ВсеНастройки = Истина;
	КонецЕсли;
КонецПроцедуры		

&НаСервере
Процедура ЗаполнитьТабличныеЧастиНаСервере()
	Об = РеквизитФормыВЗначение("Объект");
	
	Если Объект.Родитель = Справочники.НастройкиРегламентированныхОтчетов.ОПУ Тогда 
		Об.ЗагрузитьБазовыеНастройкиОПУ();
	ИначеЕсли Объект.Родитель = Справочники.НастройкиРегламентированныхОтчетов.ОИК Тогда 		
		Об.ЗагрузитьБазовыеНастройкиОИК();
	ИначеЕсли Объект.Родитель = Справочники.НастройкиРегламентированныхОтчетов.Баланс Тогда 		
		Об.ЗагрузитьБазовыеНастройкиБаланс();
	ИначеЕсли Объект.Родитель = Справочники.НастройкиРегламентированныхОтчетов.ДДС Тогда 		
		Об.ЗагрузитьБазовыеНастройкиДДС();		
	КонецЕсли;	
	
	ЗначениеВРеквизитФормы(Об, "Объект");
КонецПроцедуры

&НаСервере
Процедура НомераПроходовНаСервере()
	Об = РеквизитФормыВЗначение("Объект");
	Об.РазгруппировкаСтрок();
	ЗначениеВРеквизитФормы(Об,"Объект");
КонецПроцедуры

#КонецОбласти



