////////////////////////////////////////////////////////////////////////////////
// Функции и процедуры обеспечения формирования бухгалтерских отчетов.
//  
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

Функция ПолучитьСписокМакетовОформления() Экспорт
	
	СписокМакетовОформления = Новый СписокЗначений;
	
	Для Каждого ОбщийМакет Из Метаданные.ОбщиеМакеты Цикл
		Если ОбщийМакет.ТипМакета = Метаданные.СвойстваОбъектов.ТипМакета.МакетОформленияКомпоновкиДанных Тогда
			СписокМакетовОформления.Добавить(ОбщийМакет.Имя, ОбщийМакет.Синоним);
		КонецЕсли;
	КонецЦикла;
	
	СписокМакетовОформления.Добавить("БезОформления", "Без оформления");
	СписокМакетовОформления.Добавить("Основной"     , "Основной");
	СписокМакетовОформления.Добавить("Яркий"        , "Яркий");
	СписокМакетовОформления.Добавить("Море"         , "Море");
	СписокМакетовОформления.Добавить("Арктика"      , "Арктика");
	СписокМакетовОформления.Добавить("Зеленый"      , "Зеленый");
	СписокМакетовОформления.Добавить("Античный"     , "Античный");
	
	Возврат СписокМакетовОформления;
	
КонецФункции

// Получает данные из регистра сведений Настройки отчетов
//
// Параметры:
//  ОбъектОтчет  - СправочникСсылка.ИдентификаторыОбъектовМетаданных - Отчет для отбора
//
// Возвращаемое значение:
//   Структура   - настройки отчета
//
Функция ПолучитьНастройкиОтчета(ОбъектОтчет) Экспорт
	
	НастройкиОтчета = Новый Структура;
	НастройкиОтчета.Вставить("ВыводитьМестоДляШтампа", Ложь);
	
	НаборЗаписей = РегистрыСведений.НастройкиОтчетов.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.ОбъектОтчет.Установить(ОбъектОтчет);
	НаборЗаписей.Прочитать();
	
	Если НаборЗаписей.Количество() > 0 Тогда 
		ЗаполнитьЗначенияСвойств(НастройкиОтчета, НаборЗаписей[0]);
	КонецЕсли;	
	
	Возврат НастройкиОтчета;
	
КонецФункции

// Функция - Получить имя макета оформления
// 
// Возвращаемое значение:
//  МакетОформления - Строка
//
Функция ПолучитьИмяМакетаОформления() Экспорт

	МакетОформления = Константы.МакетОформленияОтчетов.Получить();
	
	Если МакетОформления = "Бежевый" Тогда 
		Возврат "ОформлениеОтчетовБежевый";
	ИначеЕсли МакетОформления = "Зеленый" Тогда	
		Возврат "ОформлениеОтчетовЗеленый";
	ИначеЕсли МакетОформления = "Строгий" Тогда	
		Возврат "ОформлениеОтчетовСтрогий";
	ИначеЕсли МакетОформления = "Черно-белый" Тогда	
		Возврат "ОформлениеОтчетовЧерноБелый";
	Иначе 
		Возврат Неопределено;
	КонецЕсли;	

КонецФункции // ПолучитьИмяМакетаОформления()
